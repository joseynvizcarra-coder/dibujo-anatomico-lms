<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Módulo 1: Fundamentos y Proporción - LMS Dibujo Anatómico UAH">
    <title>Módulo 1: Fundamentos - LMS UAH</title>
    
    <style>
        :root {
            --primary-dark: #2c5f66;
            --primary-light: #e8a2b8;
            --dark: #1a1a1a;
            --white: #ffffff;
            --gray-light: #f5f5f5;
            --gray-medium: #666666;
            --success: #4CAF50;
            --warning: #FFC107;
            --danger: #f44336;
            --info: #2196F3;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--gray-light);
            color: var(--dark);
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--dark) 100%);
            color: white;
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .back-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            transition: background 0.3s;
        }

        .back-btn:hover {
            background: rgba(255,255,255,0.1);
        }

        .module-title {
            font-size: 1.5rem;
        }

        .module-progress {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .progress-text {
            font-size: 1.2rem;
            font-weight: bold;
        }

        /* Layout */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
        }

        /* Sidebar */
        .sidebar {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            height: fit-content;
            position: sticky;
            top: 100px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .lesson-list {
            list-style: none;
        }

        .lesson-item {
            margin-bottom: 0.5rem;
        }

        .lesson-link {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border-radius: 8px;
            text-decoration: none;
            color: var(--dark);
            transition: all 0.3s;
            cursor: pointer;
        }

        .lesson-link:hover {
            background: var(--gray-light);
        }

        .lesson-link.active {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary-light));
            color: white;
        }

        .lesson-number {
            width: 30px;
            height: 30px;
            background: var(--gray-light);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .lesson-link.active .lesson-number {
            background: rgba(255,255,255,0.3);
        }

        .lesson-link.completed .lesson-number {
            background: var(--success);
            color: white;
        }

        /* Main Content */
        .content {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .content-header {
            border-bottom: 2px solid var(--gray-light);
            padding-bottom: 1.5rem;
            margin-bottom: 2rem;
        }

        .lesson-title {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            color: var(--dark);
        }

        .lesson-meta {
            display: flex;
            gap: 2rem;
            color: var(--gray-medium);
            font-size: 0.9rem;
        }

        .lesson-content {
            margin-bottom: 2rem;
        }

        .lesson-content h2 {
            font-size: 1.5rem;
            margin: 2rem 0 1rem;
            color: var(--primary-dark);
        }

        .lesson-content h3 {
            font-size: 1.2rem;
            margin: 1.5rem 0 0.8rem;
            color: var(--dark);
        }

        .lesson-content p {
            margin-bottom: 1rem;
            line-height: 1.8;
        }

        .lesson-content ul,
        .lesson-content ol {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }

        .lesson-content li {
            margin-bottom: 0.5rem;
        }

        /* Interactive Elements */
        .exercise-box {
            background: linear-gradient(135deg, #f0f4ff, #fef0f5);
            border-left: 4px solid var(--primary-dark);
            padding: 1.5rem;
            border-radius: 8px;
            margin: 2rem 0;
        }

        .exercise-title {
            font-weight: bold;
            color: var(--primary-dark);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .tip-box {
            background: #fff9e6;
            border-left: 4px solid var(--warning);
            padding: 1rem;
            border-radius: 8px;
            margin: 1.5rem 0;
        }

        .tip-box::before {
            content: '💡 ';
            font-size: 1.2rem;
        }

        /* Image Gallery */
        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .gallery-item {
            background: var(--gray-light);
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .gallery-item:hover {
            transform: scale(1.05);
        }

        .gallery-item img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .gallery-caption {
            padding: 0.8rem;
            font-size: 0.9rem;
            text-align: center;
            color: var(--gray-medium);
        }

        /* Video Player */
        .video-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            margin: 2rem 0;
            background: var(--gray-light);
            border-radius: 8px;
            overflow: hidden;
        }

        .video-placeholder {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--gray-medium);
        }

        .play-button {
            width: 80px;
            height: 80px;
            background: var(--primary-dark);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 1rem;
        }

        .play-button:hover {
            background: var(--primary-light);
            transform: scale(1.1);
        }

        /* Quiz Section */
        .quiz-container {
            background: var(--gray-light);
            padding: 2rem;
            border-radius: 12px;
            margin: 2rem 0;
        }

        .quiz-question {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: var(--dark);
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .quiz-option {
            padding: 1rem;
            background: white;
            border: 2px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quiz-option:hover {
            border-color: var(--primary-light);
        }

        .quiz-option.selected {
            border-color: var(--primary-dark);
            background: rgba(44, 95, 102, 0.1);
        }

        .quiz-option.correct {
            border-color: var(--success);
            background: rgba(76, 175, 80, 0.1);
        }

        .quiz-option.incorrect {
            border-color: var(--danger);
            background: rgba(244, 67, 54, 0.1);
        }

        /* Navigation Buttons */
        .lesson-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 2rem 0;
            border-top: 2px solid var(--gray-light);
            margin-top: 3rem;
        }

        .nav-button {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.8rem 1.5rem;
            background: var(--primary-dark);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
        }

        .nav-button:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
        }

        .nav-button:disabled {
            background: var(--gray-medium);
            cursor: not-allowed;
            opacity: 0.5;
            transform: none;
        }

        .complete-button {
            padding: 1rem 2rem;
            background: var(--success);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .complete-button:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        /* Progress Bar */
        .module-progress-bar {
            height: 30px;
            background: var(--gray-light);
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-dark), var(--primary-light));
            border-radius: 15px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 1rem;
            color: white;
            font-weight: bold;
        }

        /* Notification */
        .notification {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--success);
            color: white;
            padding: 1rem 2rem;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: var(--danger);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }

            .sidebar {
                position: static;
            }

            .lesson-title {
                font-size: 1.5rem;
            }

            .image-gallery {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
            }
            to {
                transform: translateX(0);
            }
        }
    </style>
</head>
<body>
    <!-- Cargar auth.js -->
    <script src="auth.js"></script>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="index.html" class="back-btn">
                <span>←</span>
                <span>Volver al Curso</span>
            </a>
            
            <h1 class="module-title">Módulo 1: Fundamentos y Proporción</h1>
            
            <div class="module-progress">
                <span class="progress-text" id="progressText">0% Completado</span>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <h3 style="margin-bottom: 1.5rem;">Lecciones</h3>
            <ul class="lesson-list">
                <li class="lesson-item">
                    <a class="lesson-link active" onclick="loadLesson(1)">
                        <span class="lesson-number">1</span>
                        <span>Introducción al Canon</span>
                    </a>
                </li>
                <li class="lesson-item">
                    <a class="lesson-link" onclick="loadLesson(2)">
                        <span class="lesson-number">2</span>
                        <span>Las 8 Cabezas</span>
                    </a>
                </li>
                <li class="lesson-item">
                    <a class="lesson-link" onclick="loadLesson(3)">
                        <span class="lesson-number">3</span>
                        <span>Proporciones Básicas</span>
                    </a>
                </li>
                <li class="lesson-item">
                    <a class="lesson-link" onclick="loadLesson(4)">
                        <span class="lesson-number">4</span>
                        <span>Estructura Esquelética</span>
                    </a>
                </li>
                <li class="lesson-item">
                    <a class="lesson-link" onclick="loadLesson(5)">
                        <span class="lesson-number">5</span>
                        <span>Ejercicios Prácticos</span>
                    </a>
                </li>
                <li class="lesson-item">
                    <a class="lesson-link" onclick="loadLesson(6)">
                        <span class="lesson-number">6</span>
                        <span>Evaluación Final</span>
                    </a>
                </li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="content fade-in" id="mainContent">
            <div class="module-progress-bar">
                <div class="progress-fill" id="moduleProgress" style="width: 0%">
                    <span>0%</span>
                </div>
            </div>

            <div class="content-header">
                <h2 class="lesson-title">Lección 1: Introducción al Canon de 8 Cabezas</h2>
                <div class="lesson-meta">
                    <span>⏱️ 30 minutos</span>
                    <span>📚 Fundamentos</span>
                    <span>🎯 Nivel: Básico</span>
                </div>
            </div>

            <div class="lesson-content" id="lessonContent">
                <!-- El contenido se carga dinámicamente -->
            </div>

            <!-- Navigation -->
            <div class="lesson-navigation">
                <button class="nav-button" disabled id="prevButton">
                    <span>←</span>
                    <span>Lección Anterior</span>
                </button>

                <button class="complete-button" onclick="completeLesson()" id="completeButton">
                    Marcar como Completada
                </button>

                <button class="nav-button" onclick="loadLesson(2)" id="nextButton">
                    <span>Siguiente Lección</span>
                    <span>→</span>
                </button>
            </div>
        </main>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <!-- Scripts -->
    <script>
        // Variables globales
        let currentUser = null;
        let currentLesson = 1;
        let moduleProgress = 0;
        let completedLessons = [];
        let lessonData = {};
        
        // Identificador del módulo actual
        window.currentModuleId = 1;

        // Contenido de las lecciones
        const lessonsContent = {
            1: {
                title: 'Introducción al Canon de 8 Cabezas',
                meta: '⏱️ 30 minutos | 📚 Fundamentos | 🎯 Nivel: Básico',
                content: `
                    <p>El canon de 8 cabezas es un sistema de proporciones utilizado desde el Renacimiento para representar la figura humana ideal. Este sistema divide el cuerpo en ocho segmentos iguales, cada uno del tamaño de la cabeza.</p>
                    <h2>¿Por qué 8 cabezas?</h2>
                    <p>Esta proporción se considera ideal para representar figuras heroicas y estilizadas. En la realidad, la mayoría de las personas miden entre 7 y 7.5 cabezas de altura, pero el canon de 8 cabezas crea una figura más elegante y proporcionada.</p>
                    <div class="tip-box"><strong>Consejo:</strong> Aunque el canon de 8 cabezas es ideal para comenzar, recuerda que las proporciones reales varían según la edad, género y características individuales.</div>
                    <div class="exercise-box">
                        <div class="exercise-title">📝 Ejercicio 1: Primera Práctica</div>
                        <p>Dibuja una línea vertical y divídela en 8 partes iguales. Marca cada división con una línea horizontal suave. Esta será tu guía base para construir la figura.</p>
                    </div>
                `
            },
            2: {
                title: 'Las 8 Divisiones del Cuerpo',
                meta: '⏱️ 35 minutos | 📚 Estructura | 🎯 Nivel: Básico',
                content: `
                    <h2>División del Cuerpo en 8 Segmentos</h2>
                    <p>El sistema de 8 cabezas divide el cuerpo humano en segmentos proporcionalmente exactos:</p>
                    <ol>
                        <li><strong>Cabeza:</strong> Desde la coronilla hasta el mentón</li>
                        <li><strong>Mentón a pecho:</strong> Incluye el cuello y parte superior del torso</li>
                        <li><strong>Pecho a ombligo:</strong> Zona del torso medio</li>
                        <li><strong>Ombligo a pubis:</strong> Parte baja del torso</li>
                        <li><strong>Pubis a mitad del muslo:</strong> Parte superior de las piernas</li>
                        <li><strong>Mitad del muslo a rodillas:</strong> Zona de las rodillas</li>
                        <li><strong>Rodillas a mitad de pantorrilla:</strong> Parte inferior de las piernas</li>
                        <li><strong>Mitad de pantorrilla a pies:</strong> Tobillos y pies</li>
                    </ol>
                    <div class="exercise-box">
                        <div class="exercise-title">📝 Ejercicio 2: Mapeo Corporal</div>
                        <p>Dibuja una figura humana básica y marca cada una de las 8 divisiones con líneas horizontales. Etiqueta cada sección.</p>
                    </div>
                `
            },
            3: {
                title: 'Proporciones Básicas y Medidas',
                meta: '⏱️ 40 minutos | 📚 Medición | 🎯 Nivel: Intermedio',
                content: `
                    <h2>Medidas Horizontales Clave</h2>
                    <p>Además de las divisiones verticales, existen proporciones horizontales importantes:</p>
                    <ul>
                        <li><strong>Ancho de hombros:</strong> 2 cabezas de ancho</li>
                        <li><strong>Ancho de caderas:</strong> 1.5 cabezas de ancho</li>
                        <li><strong>Ancho de cabeza:</strong> 0.7 cabezas de ancho</li>
                        <li><strong>Ancho de cuello:</strong> 0.3 cabezas de ancho</li>
                    </ul>
                    <h2>Puntos de Referencia Laterales</h2>
                    <ul>
                        <li>Los codos se alinean con la cintura (unidad 3)</li>
                        <li>Las muñecas se alinean con la entrepierna (unidad 4)</li>
                        <li>Los dedos alcanzan 1/3 del muslo (unidad 5)</li>
                    </ul>
                    <div class="exercise-box">
                        <div class="exercise-title">📝 Ejercicio 3: Verificación de Proporciones</div>
                        <p>Toma una fotografía de referencia y verifica las proporciones usando el sistema de 8 cabezas. Identifica desviaciones y analiza por qué ocurren.</p>
                    </div>
                `
            },
            4: {
                title: 'Estructura Esquelética Fundamental',
                meta: '⏱️ 45 minutos | 📚 Anatomía | 🎯 Nivel: Intermedio',
                content: `
                    <h2>Base Esquelética del Canon</h2>
                    <p>El canon de 8 cabezas se basa en la estructura ósea humana. Comprender la anatomía básica mejora la precisión del dibujo:</p>
                    <h3>Puntos Óseos Clave</h3>
                    <ul>
                        <li><strong>Cráneo:</strong> Determina la unidad de medida base</li>
                        <li><strong>Clavículas:</strong> Marcan el ancho de los hombros</li>
                        <li><strong>Caja torácica:</strong> Define el volumen del pecho</li>
                        <li><strong>Pelvis:</strong> Establece el ancho de las caderas</li>
                        <li><strong>Fémur:</strong> Hueso más largo, determina la proporción de las piernas</li>
                    </ul>
                    <div class="tip-box"><strong>Importante:</strong> La estructura ósea es constante, pero los músculos y tejidos pueden variar significativamente entre individuos.</div>
                    <div class="exercise-box">
                        <div class="exercise-title">📝 Ejercicio 4: Esqueleto Básico</div>
                        <p>Dibuja un esqueleto simplificado usando formas geométricas básicas, respetando las proporciones del canon de 8 cabezas.</p>
                    </div>
                `
            },
            5: {
                title: 'Ejercicios Prácticos de Proporción',
                meta: '⏱️ 60 minutos | 📚 Práctica | 🎯 Nivel: Intermedio',
                content: `
                    <h2>Ejercicios de Aplicación</h2>
                    <p>La práctica constante es esencial para dominar el canon de 8 cabezas. Estos ejercicios te ayudarán a internalizar las proporciones:</p>
                    
                    <div class="exercise-box">
                        <div class="exercise-title">📝 Ejercicio 5A: Figuras Básicas</div>
                        <p>Dibuja 10 figuras humanas básicas usando solo formas geométricas (círculos, rectángulos, líneas). Enfócate únicamente en las proporciones, no en detalles.</p>
                    </div>
                    
                    <div class="exercise-box">
                        <div class="exercise-title">📝 Ejercicio 5B: Diferentes Ángulos</div>
                        <p>Dibuja la misma figura desde 4 ángulos diferentes: frontal, perfil, 3/4 y espalda. Mantén las proporciones consistentes.</p>
                    </div>
                    
                    <div class="exercise-box">
                        <div class="exercise-title">📝 Ejercicio 5C: Corrección de Errores</div>
                        <p>Se te proporcionan dibujos con errores de proporción. Identifica y corrige cada error usando el sistema de 8 cabezas.</p>
                    </div>
                    
                    <h2>Diferencias Anatómicas</h2>
                    <h3>Canon Masculino vs Femenino</h3>
                    <p><strong>Figura Masculina:</strong></p>
                    <ul>
                        <li>Hombros más anchos (2.2 cabezas)</li>
                        <li>Caderas más estrechas (1.3 cabezas)</li>
                        <li>Torso más rectangular</li>
                        <li>Extremidades más angulosas</li>
                    </ul>
                    <p><strong>Figura Femenina:</strong></p>
                    <ul>
                        <li>Hombros moderados (1.8 cabezas)</li>
                        <li>Caderas más anchas (1.6 cabezas)</li>
                        <li>Cintura más definida</li>
                        <li>Curvas más suaves</li>
                    </ul>
                `
            },
            6: {
                title: 'Evaluación Final del Módulo',
                meta: '⏱️ 90 minutos | 📚 Evaluación | 🎯 Nivel: Aplicación',
                content: `
                    <h2>Proyecto Final: Portfolio de Proporciones</h2>
                    <p>Para completar este módulo, debes crear un portfolio que demuestre tu dominio del canon de 8 cabezas:</p>
                    
                    <div class="exercise-box">
                        <div class="exercise-title">📝 Proyecto Final</div>
                        <p><strong>Entregables requeridos:</strong></p>
                        <ol>
                            <li><strong>Guía de construcción:</strong> Diagrama paso a paso del canon de 8 cabezas</li>
                            <li><strong>Figuras masculinas:</strong> 3 dibujos (frontal, perfil, 3/4)</li>
                            <li><strong>Figuras femeninas:</strong> 3 dibujos (frontal, perfil, 3/4)</li>
                            <li><strong>Análisis comparativo:</strong> Diferencias entre canon masculino y femenino</li>
                            <li><strong>Poses dinámicas:</strong> 2 figuras en movimiento manteniendo proporciones</li>
                            <li><strong>Autorreflexión:</strong> 300 palabras sobre tu proceso de aprendizaje</li>
                        </ol>
                        <p><strong>Criterios de evaluación:</strong></p>
                        <ul>
                            <li>Precisión proporcional (40%)</li>
                            <li>Aplicación metodológica (30%)</li>
                            <li>Creatividad en poses (20%)</li>
                            <li>Limpieza de ejecución (10%)</li>
                        </ul>
                    </div>
                    
                    <h2>Evaluación Teórica</h2>
                    <div class="quiz-container">
                        <div class="quiz-question">¿Cuál es la principal ventaja del canon de 8 cabezas sobre las proporciones naturales?</div>
                        <div class="quiz-options">
                            <div class="quiz-option" onclick="selectAnswer(this, false)">Es más rápido de dibujar</div>
                            <div class="quiz-option" onclick="selectAnswer(this, false)">Usa menos líneas de construcción</div>
                        </div>
                    </div>
                    
                    <h2>Próximos Pasos</h2>
                    <p>Al completar este módulo habrás dominado:</p>
                    <ul>
                        <li>✅ Sistema de proporciones clásico</li>
                        <li>✅ Construcción básica de figuras</li>
                        <li>✅ Diferencias anatómicas fundamentales</li>
                        <li>✅ Metodología de autocorrección</li>
                    </ul>
                    <p>Estarás preparado para el <strong>Módulo 2: Anatomía Facial</strong>, donde aplicarás estos conocimientos al estudio detallado del rostro humano.</p>
                `
            }
        };

        // Inicialización
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Inicializando Módulo 1...');
            
            // Verificar autenticación
            if (typeof getCurrentUser !== 'undefined' && typeof protectPage !== 'undefined') {
                if (!protectPage()) {
                    return;
                }
                currentUser = getCurrentUser();
            } else {
                // Si no hay auth.js, verificar localStorage
                const storedUser = localStorage.getItem('currentUser');
                if (storedUser) {
                    currentUser = JSON.parse(storedUser);
                } else {
                    // Redirigir a login si no hay usuario
                    window.location.href = 'login.html';
                    return;
                }
            }

            console.log('Usuario en módulo:', currentUser);

            // Cargar progreso
            loadModuleProgress();
            
            // Cargar primera lección
            loadLesson(1);
            
            // Registrar actividad
            if (typeof logUserActivity === 'function') {
                logUserActivity('module_access', currentUser, { 
                    moduleId: 1,
                    moduleTitle: 'Fundamentos y Proporción'
                });
            }
        });

        // Cargar progreso del módulo
        function loadModuleProgress() {
            const progressKey = `progress_${currentUser.username || currentUser.email}`;
            const userProgress = JSON.parse(localStorage.getItem(progressKey) || 'null');
            
            if (userProgress && userProgress.modules[1]) {
                moduleProgress = userProgress.modules[1].progress || 0;
                completedLessons = userProgress.modules[1].completedLessons || [];
            }
            
            updateProgressDisplay();
            updateSidebarProgress();
        }

        // Actualizar visualización del progreso
        function updateProgressDisplay() {
            document.getElementById('progressText').textContent = moduleProgress + '% Completado';
            
            const progressBar = document.getElementById('moduleProgress');
            progressBar.style.width = moduleProgress + '%';
            progressBar.querySelector('span').textContent = moduleProgress + '%';
        }

        // Actualizar progreso en sidebar
        function updateSidebarProgress() {
            document.querySelectorAll('.lesson-link').forEach((link, index) => {
                const lessonNumber = index + 1;
                if (completedLessons.includes(lessonNumber)) {
                    link.classList.add('completed');
                }
            });
        }

        // Cargar lección específica
        function loadLesson(lessonNumber) {
            currentLesson = lessonNumber;
            
            // Actualizar sidebar
            document.querySelectorAll('.lesson-link').forEach((link, index) => {
                link.classList.remove('active');
                if (index + 1 === lessonNumber) {
                    link.classList.add('active');
                }
            });

            // Actualizar contenido
            const lesson = lessonsContent[lessonNumber];
            if (lesson) {
                document.querySelector('.lesson-title').textContent = lesson.title;
                document.querySelector('.lesson-meta').innerHTML = lesson.meta;
                document.getElementById('lessonContent').innerHTML = lesson.content;
            }

            // Actualizar botones de navegación
            updateNavigationButtons();

            // Animación de contenido
            const content = document.getElementById('mainContent');
            content.classList.remove('fade-in');
            setTimeout(() => {
                content.classList.add('fade-in');
            }, 100);

            console.log('Lección cargada:', lessonNumber);
        }

        // Actualizar botones de navegación
        function updateNavigationButtons() {
            const prevButton = document.getElementById('prevButton');
            const nextButton = document.getElementById('nextButton');
            const completeButton = document.getElementById('completeButton');

            // Botón anterior
            if (currentLesson <= 1) {
                prevButton.disabled = true;
            } else {
                prevButton.disabled = false;
                prevButton.onclick = () => loadLesson(currentLesson - 1);
            }

            // Botón siguiente
            if (currentLesson >= 6) {
                nextButton.style.display = 'none';
            } else {
                nextButton.style.display = 'flex';
                nextButton.onclick = () => loadLesson(currentLesson + 1);
            }

            // Botón completar
            if (completedLessons.includes(currentLesson)) {
                completeButton.textContent = '✓ Lección Completada';
                completeButton.style.background = 'var(--success)';
            } else {
                completeButton.textContent = 'Marcar como Completada';
                completeButton.style.background = 'var(--success)';
            }
        }

        // Completar lección
        function completeLesson() {
            if (!completedLessons.includes(currentLesson)) {
                completedLessons.push(currentLesson);
                
                // Calcular nuevo progreso
                moduleProgress = Math.round((completedLessons.length / 6) * 100);
                
                // Guardar progreso
                saveProgress();
                
                // Actualizar UI
                updateProgressDisplay();
                updateSidebarProgress();
                updateNavigationButtons();
                
                // Mostrar notificación
                if (currentLesson === 6 && moduleProgress >= 100) {
                    showNotification('¡Felicitaciones! Has completado todo el módulo');
                    
                    // Redirigir al index después de completar
                    setTimeout(() => {
                        window.location.href = 'index.html';
                    }, 3000);
                } else {
                    showNotification('¡Lección completada!');
                    
                    // Auto-avanzar si no es la última lección
                    if (currentLesson < 6) {
                        setTimeout(() => {
                            loadLesson(currentLesson + 1);
                        }, 2000);
                    }
                }
            }
        }

        // Guardar progreso
        function saveProgress() {
            const progressKey = `progress_${currentUser.username || currentUser.email}`;
            let userProgress = JSON.parse(localStorage.getItem(progressKey) || 'null');
            
            if (!userProgress) {
                userProgress = {
                    modules: {
                        1: { completed: false, progress: 0, timeSpent: 0, completedLessons: [] },
                        2: { completed: false, progress: 0, timeSpent: 0, completedLessons: [] },
                        3: { completed: false, progress: 0, timeSpent: 0, completedLessons: [] },
                        4: { completed: false, progress: 0, timeSpent: 0, completedLessons: [] }
                    },
                    overallProgress: 0,
                    totalTimeSpent: 0,
                    lastActivity: new Date().toISOString()
                };
            }

            // Actualizar módulo 1
            userProgress.modules[1].progress = moduleProgress;
            userProgress.modules[1].completed = moduleProgress >= 100;
            userProgress.modules[1].completedLessons = completedLessons;
            userProgress.modules[1].lastUpdate = new Date().toISOString();

            // Calcular progreso general
            let totalProgress = 0;
            let completedCount = 0;
            
            for (let id in userProgress.modules) {
                totalProgress += userProgress.modules[id].progress || 0;
                if (userProgress.modules[id].completed) {
                    completedCount++;
                }
            }
            
            userProgress.overallProgress = Math.round(totalProgress / 4);
            userProgress.lastActivity = new Date().toISOString();

            localStorage.setItem(progressKey, JSON.stringify(userProgress));

            // Registrar actividad
            if (typeof logUserActivity === 'function') {
                logUserActivity('lesson_completed', currentUser, {
                    moduleId: 1,
                    lessonId: currentLesson,
                    progress: moduleProgress
                });
            }
            
            console.log(`Progreso guardado: Módulo 1, ${moduleProgress}% completado`);
        }

        // Funciones de quiz
        function selectAnswer(element, isCorrect) {
            // Resetear todas las opciones
            document.querySelectorAll('.quiz-option').forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
            });

            // Marcar seleccionada
            element.classList.add('selected');
            
            // Mostrar resultado después de un delay
            setTimeout(() => {
                if (isCorrect) {
                    element.classList.add('correct');
                    showNotification('¡Correcto!');
                } else {
                    element.classList.add('incorrect');
                    showNotification('Intenta de nuevo', 'error');
                }
            }, 500);
        }

        // Reproducir video (placeholder)
        function playVideo() {
            showNotification('Video player: En una implementación real, aquí se reproduciría el video educativo.', 'info');
        }

        // Mostrar notificación
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Obtener título de lección
        function getLessonTitle(num) {
            const lesson = lessonsContent[num];
            return lesson ? lesson.title : 'Lección';
        }

        // Manejar errores
        window.addEventListener('error', function(e) {
            console.error('Error en módulo:', e);
            showNotification('Ha ocurrido un error. Recarga la página si persiste.', 'error');
        });
    </script>
</body>
</html)">Es más fácil de memorizar</div>
                            <div class="quiz-option" onclick="selectAnswer(this, true)">Crea figuras más elegantes y heroicas</div>
                            <div class="quiz-option" onclick="selectAnswer(this, false