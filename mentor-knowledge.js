// ============================================
// MENTOR ANAT√ìMICO 2.0 - BASE DE CONOCIMIENTO
// ============================================

(function() {
    'use strict';

    // ============================================
    // 1. BASE DE CONOCIMIENTO EMOCIONAL (25)
    // ============================================
    const emotionalKnowledge = {
        frustracion: {
            keywords: ['frustrado', 'frustrada', 'frustrante', 'no puedo', 'no me sale', 'horrible', 'mal'],
            responses: {
                leve: {
                    text: "Hey, respira üíô. La frustraci√≥n es se√±al de que est√°s aprendiendo algo nuevo. Tu cerebro est√° expandi√©ndose.\n\n**T√©cnica r√°pida:** Respira 4 segundos (inhala) - 4 segundos (sost√©n) - 6 segundos (exhala). Hazlo 3 veces.\n\nLuego vuelve al dibujo con curiosidad, no con juicio.",
                    actions: ['Estoy mejor, gracias', 'Necesito m√°s ayuda']
                },
                media: {
                    text: "Entiendo que est√©s frustrado/a. El 78% del curso pasa por esto en alg√∫n punto. **Eres normal**.\n\n**Lo que pasa:** Tu ojo ve M√ÅS r√°pido de lo que tu mano puede hacer. Esa brecha genera frustraci√≥n.\n\n**La soluci√≥n:** No es dibujar mejor HOY. Es dibujar CONSISTENTE. La brecha se cierra con tiempo, no con fuerza.",
                    actions: ['¬øCu√°nto tiempo?', 'Dame un ejercicio']
                },
                alta: {
                    text: "Primero: **PARA**. No dibujes ahora. En serio.\n\n**Haz esto:**\n1. Cierra tu cuaderno\n2. Sal a caminar 10 minutos\n3. Toma agua\n4. Vuelve cuando est√©s m√°s tranquilo/a\n\nDibujar con mucha frustraci√≥n entrena **malos h√°bitos**. Es contraproducente.\n\n¬øNecesitas que hablemos de por qu√© te frustras tanto?",
                    actions: ['S√≠, hablemos', 'Solo necesitaba escuchar eso']
                }
            }
        },
        
        comparacion: {
            keywords: ['mejor que yo', 'peor que', 'otros dibujan', 'talento', 'nunca voy a', 'no tengo'],
            responses: {
                text: "üõë **Alto ah√≠**. Compararse es el asesino silencioso del progreso creativo.\n\n**Verdad dura:** Siempre habr√° alguien \"mejor\". Siempre. Incluso los profesionales se comparan entre ellos.\n\n**La pregunta real:** ¬øDibujas mejor que AYER? Esa es la √∫nica comparaci√≥n v√°lida.\n\nComp√°rate con tu yo de hace 1 semana. Ese es tu √∫nico oponente.",
                actions: ['Tienes raz√≥n', '¬øY si no veo progreso?']
            }
        },
        
        impostor: {
            keywords: ['no merezco', 'soy un fraude', 'suerte', 'enga√±o', 'no soy artista'],
            responses: {
                text: "S√≠ndrome del impostor detectado üîç. El 70% de artistas lo experimenta.\n\n**Realidad:** Si HACES arte, ERES artista. Punto. No necesitas permiso, diploma o validaci√≥n externa.\n\n**Tip:** Cada vez que pienses \"no soy artista\", reempl√°zalo por: \"Soy un artista en desarrollo\". Peque√±o cambio, gran impacto.\n\nTu pr√°ctica te hace artista, no tu inseguridad.",
                actions: ['Me ayuda o√≠r eso', 'Pero mis dibujos son malos']
            }
        },
        
        bloqueo: {
            keywords: ['bloqueado', 'bloqueada', 'no se que dibujar', 'blanco', 'sin ideas', 'vac√≠o'],
            responses: {
                text: "Bloqueo creativo es falta de INPUT, no falta de OUTPUT.\n\n**Ejercicio anti-bloqueo (15 min):**\n1. Ve 20 fotos de Pinterest (poses humanas)\n2. Elige la que m√°s te llame\n3. Dib√∫jala EN 5 MINUTOS (s√≠, mal hecho)\n4. Elige otra\n5. Repite\n\nEl bloqueo se rompe con VOLUMEN, no con perfecci√≥n.\n\nNo pienses. Solo dibuja.",
                actions: ['Voy a intentarlo', '¬øD√≥nde encuentro referencias?']
            }
        },
        
        ansiedad: {
            keywords: ['ansioso', 'ansiosa', 'nervios', 'estresado', 'estresada', 'presi√≥n'],
            responses: {
                text: "La ansiedad es energ√≠a mal dirigida. Vamos a redirigirla.\n\n**T√©cnica 5-4-3-2-1:**\n- 5 cosas que VES\n- 4 que TOCAS\n- 3 que ESCUCHAS\n- 2 que HUELES\n- 1 que SABOREAS\n\nEsto te ancla al presente. La ansiedad vive en el futuro (\"¬øy si...?\").\n\nDibuja por dibujar, no por el resultado.",
                actions: ['Lo har√©', 'Mi ansiedad es por la evaluaci√≥n']
            }
        },
        
        perfeccionismo: {
            keywords: ['perfecto', 'perfecta', 'tiene que quedar bien', 'no est√° bien', 'borrar todo'],
            responses: {
                text: "El perfeccionismo NO es excelencia. Es miedo disfrazado.\n\n**Regla del 80/20:** Un dibujo al 80% de \"perfecci√≥n\" te ense√±a m√°s que uno al 100%.\n\n¬øPor qu√©? Porque TERMINAS m√°s. Y terminar > perfeccionar.\n\n**Ejercicio:** Haz tu siguiente dibujo en la MITAD del tiempo que normalmente usar√≠as. Prohibido borrar. Solo avanzar.\n\n√Åbraza lo \"feo\". Ah√≠ est√° el aprendizaje real.",
                actions: ['Me cuesta no borrar', 'Voy a intentar']
            }
        },
        
        cansancio: {
            keywords: ['cansado', 'cansada', 'agotado', 'agotada', 'no tengo energ√≠a', 'sue√±o'],
            responses: {
                text: "Dibujar cansado/a = entrenar con gripe. Contraproducente.\n\n**Prioriza:**\n1. Dormir 7-8 horas\n2. Comer bien\n3. Moverte un poco\n4. DESPU√âS dibujar\n\nTu creatividad necesita energ√≠a f√≠sica. No eres flojo/a, est√°s sin combustible.\n\nDescansa hoy, dibuja ma√±ana. El curso no se va a ning√∫n lado.",
                actions: ['Necesitaba escuchar esto', 'Pero tengo deadline']
            }
        },
        
        miedo: {
            keywords: ['miedo', 'temor', 'asusta', 'da p√°nico', 'terror'],
            responses: {
                text: "El miedo al error es el enemigo #1 del aprendizaje.\n\n**Verdad liberadora:** Los dibujos \"malos\" te ense√±an M√ÅS que los \"buenos\".\n\nCada error es data. Data = aprendizaje.\n\n**Mantra:** \"Este dibujo no define mi valor como artista\".\n\nRep√≠telo antes de cada pr√°ctica. El miedo se disuelve con repetici√≥n.",
                actions: ['¬øY si sigo teniendo miedo?', 'Voy a intentarlo']
            }
        },
        
        desmotivacion: {
            keywords: ['desmotivado', 'desmotivada', 'sin ganas', 'para qu√©', 'no vale la pena'],
            responses: {
                text: "Desmotivaci√≥n = expectativas vs. realidad desalineadas.\n\n**Pregunta honesta:** ¬øPor qu√© empezaste este curso?\n\nReconecta con ESO. No con lo que Instagram dice que deber√≠as lograr.\n\n**Micro-motivaci√≥n:** Proponte dibujar solo 5 minutos hoy. SOLO 5. Usualmente continuar√°s, pero si no, 5 minutos > 0 minutos.\n\nLa motivaci√≥n sigue a la acci√≥n, no al rev√©s.",
                actions: ['Voy a intentar 5 minutos', 'Ya no me acuerdo por qu√© empec√©']
            }
        },
        
        llanto: {
            keywords: ['llorar', 'lloro', 'l√°grimas', 'ganas de llorar', 'llor√©'],
            responses: {
                text: "Llorar est√° bien. En serio. No es debilidad.\n\nEst√°s procesando frustraci√≥n, expectativa, esfuerzo. Eso es HUMANO.\n\n**Permiso oficial:** Llora si necesitas. Luego l√°vate la cara, toma agua, respira.\n\nCuando est√©s listo/a, vuelve. O no. Puedes descansar hoy.\n\nTu bienestar > cualquier dibujo. Siempre. üíô",
                actions: ['Gracias, necesitaba esto', 'Estoy mejor ahora']
            }
        }
    };

    // ============================================
    // 2. BASE DE CONOCIMIENTO T√âCNICO (25)
    // ============================================
    const technicalKnowledge = {
        // M√ìDULO 1: Observaci√≥n y Gesto (8 respuestas)
        lineaAccion: {
            keywords: ['linea de accion', 'linea accion', 'gesto', 'movimiento', 'dinamica'],
            responses: {
                text: "**L√≠nea de acci√≥n** = La curva imaginaria que atraviesa el cuerpo mostrando su movimiento principal.\n\n**C√≥mo encontrarla:**\n1. Ignora detalles\n2. Busca la curva desde cabeza a pies\n3. Dib√∫jala en 1 segundo\n\n**Tip:** Piensa en una 'S', 'C' o l√≠nea recta. Esas son las 3 formas base.\n\nCroquis empieza SIEMPRE con la l√≠nea de acci√≥n. Todo lo dem√°s se construye sobre ella.",
                actions: ['Dame un ejemplo', 'Entendido']
            }
        },
        
        medirProporcion: {
            keywords: ['medir', 'proporcion', 'proporciones', 'lapiz', 'medicion'],
            responses: {
                text: "**Medir con el l√°piz:**\n1. Estira el brazo COMPLETO (importante)\n2. Cierra un ojo\n3. Usa el l√°piz como regla\n4. La cabeza suele ser tu \"unidad\"\n\n**Proporci√≥n b√°sica:** Cuerpo humano = 7-8 cabezas de altura.\n\n**Error com√∫n:** Doblar el codo. Eso cambia la medici√≥n. Brazo siempre extendido.\n\nPractica midiendo objetos simples primero (botellas, cajas).",
                actions: ['¬øC√≥mo practico?', 'Claro, gracias']
            }
        },
        
        contrapposto: {
            keywords: ['contrapposto', 'contraposto', 'peso', 'cadera', 'hombros'],
            responses: {
                text: "**Contrapposto** = Cuando el cuerpo pone peso en una pierna, creando √°ngulos opuestos en cadera y hombros.\n\n**Regla simple:**\n- Cadera sube del lado donde HAY peso\n- Hombro BAJA del mismo lado\n\n**Por qu√© importa:** Hace poses naturales, no r√≠gidas.\n\n**Ejercicio:** P√°rate frente al espejo, pon peso en una pierna. Observa c√≥mo tu cuerpo se ajusta autom√°ticamente.",
                actions: ['Ah, ya veo', '¬øC√≥mo lo dibujo?']
            }
        },
        
        croquis2min: {
            keywords: ['croquis rapido', 'croquis 2', '2 minutos', 'rapido', 'tiempo'],
            responses: {
                text: "**Croquis de 2 minutos:**\n1. 10 segundos: L√≠nea de acci√≥n\n2. 30 segundos: Masas principales (cabeza, torso, pelvis)\n3. 60 segundos: Brazos y piernas (cilindros)\n4. 20 segundos: Manos/pies (formas simples)\n\n**Prohibido:**\n- Borrar\n- Detalles (ojos, dedos, ropa)\n- Dudar\n\n**Permitido:**\n- L√≠neas sucias\n- \"Fealdad\"\n- Avanzar siempre\n\nObjetivo: CAPTURAR, no embellecer.",
                actions: ['¬øD√≥nde practico?', 'Entendido']
            }
        },
        
        puntoApoyo: {
            keywords: ['punto de apoyo', 'apoyo', 'equilibrio', 'balance'],
            responses: {
                text: "**Punto de apoyo** = Donde el cuerpo toca el suelo y sostiene el peso.\n\n**En una pose parado:**\n- 1 pierna: punto de apoyo bajo ese pie\n- 2 piernas: puntos de apoyo en ambos pies\n\n**Truco visual:** Imagina una l√≠nea vertical desde el centro de gravedad (ombligo aprox). Debe caer dentro del √°rea de apoyo.\n\n**Si no:** La figura se ve como que va a caer.\n\nPractica dibujando la l√≠nea de gravedad primero.",
                actions: ['Claro', 'Dame un ejemplo']
            }
        },
        
        balanceVisual: {
            keywords: ['balance', 'balanceado', 'estable', 'inestable'],
            responses: {
                text: "**Balance visual:**\n- El cuerpo se organiza alrededor de su eje central\n- Peso distribuido para no caer\n\n**Checkeo r√°pido:**\n1. Dibuja l√≠nea vertical desde cuello\n2. ¬øCae entre los pies? ‚úì Estable\n3. ¬øCae fuera? ‚úó Se va a caer\n\n**En movimiento:** El balance se rompe INTENCIONALMENTE (corriendo, saltando).\n\n**Tip:** M√≠rate al espejo parado en una pierna. Observa c√≥mo tu cuerpo se ajusta.",
                actions: ['Entiendo', '¬øY en acci√≥n?']
            }
        },
        
        proporcionesBasicas: {
            keywords: ['proporciones basicas', 'canon', 'medidas', 'altura'],
            responses: {
                text: "**Proporciones b√°sicas del cuerpo:**\n- Adulto: 7.5-8 cabezas de altura\n- Ombligo: mitad del cuerpo (aprox)\n- Brazos extendidos: mismo ancho que altura\n- Manos: desde ment√≥n a cejas\n- Pies: 1 cabeza de largo\n\n**No memorices.** Observa personas reales.\n\nLas proporciones var√≠an (alto, bajo, delgado, robusto). Estas son solo GU√çA.\n\nTu ojo es mejor que cualquier regla.",
                actions: ['OK, observar√© m√°s', 'Gracias']
            }
        },
        
        observacion: {
            keywords: ['observar', 'observacion', 'ver', 'mirar', 'como observar'],
            responses: {
                text: "**Observaci√≥n efectiva:**\n\n**1. Visi√≥n global primero**\nForma general ‚Üí Masas ‚Üí Detalles (en ese orden)\n\n**2. Dibuja lo que VES, no lo que SABES**\nEjemplo: No dibujes \"mano\", dibuja \"estas 5 formas\".\n\n**3. Medici√≥n constante**\nCompara todo con todo. \"Este brazo es 2x la cabeza\"\n\n**Ejercicio:** Mira un objeto 30 segundos sin dibujar. LUEGO dibuja. Tu observaci√≥n mejorar√° 10x.",
                actions: ['Voy a practicar', 'Interesante']
            }
        },

        // M√ìDULO 2: Anatom√≠a Funcional (9 respuestas)
        tresMasas: {
            keywords: ['3 masas', 'tres masas', 'masas', 'bloques', 'torso'],
            responses: {
                text: "**Las 3 masas corporales:**\n\n1. **Cabeza** = Esfera/huevo\n2. **Torso** = Caja de costillas (mayor volumen)\n3. **Pelvis** = Cubo/cuenco\n\n**Por qu√© importa:** Son los bloques que NO se deforman mucho. Todo lo dem√°s (brazos, piernas) se conecta A ellos.\n\n**Error com√∫n:** Dibujar el torso como una l√≠nea. Es un VOLUMEN 3D.\n\n**Pr√°ctica:** Dibuja solo estas 3 masas en diferentes poses. Ignora todo lo dem√°s.",
                actions: ['Entendido', 'Dame un ejercicio']
            }
        },
        
        gruposMusculares: {
            keywords: ['musculos', 'musculares', '6 grupos', 'grupos musculares'],
            responses: {
                text: "**6 grupos musculares esenciales:**\n\n1. **Trapecio** (cuello a hombros)\n2. **Pectorales** (pecho)\n3. **Deltoides** (hombros)\n4. **Abdominales** (core)\n5. **Gl√∫teos** (cadera)\n6. **Cu√°driceps** (muslos)\n\n**No necesitas anatom√≠a m√©dica.** Solo formas b√°sicas.\n\n**Tip:** Piensa en ellos como \"bultos\" que cambian la silueta.\n\nDibuja primero el esqueleto simple, luego agrega estos bultos.",
                actions: ['OK', '¬øC√≥mo memorizo?']
            }
        },
        
        manosPies: {
            keywords: ['manos', 'pies', 'dedos', 'mano', 'pie'],
            responses: {
                text: "**Manos y pies simplificados:**\n\n**MANOS:**\n- Palma = rect√°ngulo con grosor\n- Dedos = 3 cilindros cada uno\n- Pulgar = LATERAL, no frontal\n\n**PIES:**\n- Pie = cu√±a/tri√°ngulo 3D\n- Dedos = peque√±os cilindros\n- Tal√≥n = parte m√°s ancha\n\n**Error #1:** Dibujar contorno sin estructura 3D.\n\n**Soluci√≥n:** Siempre empieza con el BLOQUE, luego agrega dedos.\n\nPractica dibujando TUS manos primero.",
                actions: ['Voy a practicar', 'Claro']
            }
        },
        
        estructuraMano: {
            keywords: ['mano plana', 'mano se ve mal', 'mano estructura', 'palma'],
            responses: {
                text: "**Por qu√© tu mano se ve plana:**\n\nDibujas CONTORNO sin VOLUMEN.\n\n**Soluci√≥n 3D:**\n1. Palma = bloque rectangular con GROSOR\n2. Nudillos = 4 esferas en fila\n3. Dedos = cilindros que salen de esas esferas\n4. Pulgar conecta LATERALMENTE\n\n**Ejercicio ahora (10 min):**\nDibuja TU mano:\n1. Solo la palma como bloque (3 min)\n2. Agrega un dedo con sus 3 cilindros (3 min)\n3. Completa los dem√°s (4 min)\n\nNo busques perfecci√≥n, busca ESTRUCTURA.",
                actions: ['Lo har√©', 'Gracias']
            }
        },
        
        rostroProporcion: {
            keywords: ['rostro', 'cara', 'proporciones cara', 'ojos', 'nariz'],
            responses: {
                text: "**Proporciones faciales b√°sicas:**\n\n- Ojos: mitad de la cabeza (vertical)\n- Nariz: mitad entre ojos y ment√≥n\n- Boca: mitad entre nariz y ment√≥n\n- Ancho de ojo = espacio entre ojos\n- Orejas: desde cejas a nariz\n\n**Regla de tercios:**\nCabeza = 3 partes: frente, nariz, ment√≥n.\n\n**Importante:** Estas son GU√çAS, no leyes. Las caras var√≠an mucho.\n\nObserva rostros reales, no memorices n√∫meros.",
                actions: ['Entiendo', 'OK']
            }
        },
        
        anatomiaFuncional: {
            keywords: ['anatomia funcional', 'como funciona', 'movimiento anatomia'],
            responses: {
                text: "**Anatom√≠a funcional** = Entender c√≥mo el cuerpo se MUEVE, no solo c√≥mo se ve.\n\n**Ejemplo:**\n- Hombro NO es una esfera fija\n- Se mueve adelante, atr√°s, arriba, abajo\n- Dib√∫jalo seg√∫n la ACCI√ìN, no seg√∫n la foto\n\n**Enfoque correcto:**\n1. ¬øQu√© est√° haciendo el cuerpo?\n2. ¬øQu√© m√∫sculos se activan?\n3. ¬øC√≥mo cambia la forma?\n\n**No necesitas ser m√©dico.** Solo observar y entender causa-efecto.\n\nDibuja acciones (empujar, jalar, torcer), no solo poses est√°ticas.",
                actions: ['Interesante', 'Dame ejemplo']
            }
        },
        
        estructura3D: {
            keywords: ['3d', 'tridimensional', 'volumen', 'profundidad', 'plano'],
            responses: {
                text: "**Pensar en 3D:**\n\nTodo es un VOLUMEN, no una forma plana.\n\n**Ejercicio mental:**\n- Brazo NO es l√≠nea ‚Üí es CILINDRO\n- Torso NO es rect√°ngulo ‚Üí es CAJA\n- Cabeza NO es c√≠rculo ‚Üí es ESFERA\n\n**T√©cnica pr√°ctica:**\n1. Dibuja la forma 3D simple (cilindro, cubo, esfera)\n2. Agrega el eje central\n3. Construye detalles sobre eso\n\n**Tip:** Practica dibujando solo cilindros y cajas en diferentes √°ngulos.\n\nDomina el volumen, el resto fluye.",
                actions: ['Voy a practicar formas', 'Entendido']
            }
        },
        
        articulaciones: {
            keywords: ['articulaciones', 'articulacion', 'codos', 'rodillas', 'union'],
            responses: {
                text: "**Articulaciones simplificadas:**\n\n- Hombro = esfera (movimiento amplio)\n- Codo = bisagra (solo dobla)\n- Mu√±eca = esfera peque√±a\n- Cadera = esfera (movimiento amplio)\n- Rodilla = bisagra (solo dobla)\n- Tobillo = bisagra + rotaci√≥n ligera\n\n**Regla de oro:** Donde dos cilindros se juntan, hay una ESFERA.\n\n**Error com√∫n:** Articulaciones que se doblan donde no deben.\n\nDibuja el esqueleto simple primero, luego agrega forma.",
                actions: ['Claro', 'OK']
            }
        },
        
        escorzo: {
            keywords: ['escorzo', 'perspectiva', 'angulo', 'acortamiento'],
            responses: {
                text: "**Escorzo** = Cuando una parte del cuerpo apunta hacia ti o se aleja.\n\n**Efecto:** Se ve M√ÅS CORTA de lo que es.\n\n**Ejemplo:** Brazo extendido hacia ti\n- En realidad: largo\n- En dibujo: c√≠rculo (hombro) + mano grande\n\n**T√©cnica:**\n1. Dibuja el cilindro en perspectiva\n2. Las elipses (cortes) muestran la profundidad\n3. Lo que est√° cerca = m√°s grande\n4. Lo que est√° lejos = m√°s peque√±o\n\n**Practica:** Toma foto de tu brazo apuntando a la c√°mara. Dib√∫jalo.",
                actions: ['Voy a intentar', 'Entiendo']
            }
        },

        // M√ìDULO 3: Figura Completa (5 respuestas)
        procesoCapas: {
            keywords: ['proceso capas', 'capas', 'proceso dibujo', 'pasos'],
            responses: {
                text: "**Proceso por capas:**\n\n**Capa 1: Gesto (30 seg)**\nL√≠nea de acci√≥n + masas principales\n\n**Capa 2: Estructura (2 min)**\nCilindros para brazos/piernas, cubos para torso/pelvis\n\n**Capa 3: Anatom√≠a (3 min)**\nFormas musculares b√°sicas\n\n**Capa 4: Refinamiento (4+ min)**\nContorno limpio, detalles\n\n**Capa 5: Valores (opcional)**\nLuz y sombra\n\n**Regla:** NUNCA saltes capas. Cada una es fundamento de la siguiente.",
                actions: ['Entendido', '¬øCu√°nto tarda?']
            }
        },
        
        valoresTonales: {
            keywords: ['valores', 'tonales', 'luz', 'sombra', 'sombreado'],
            responses: {
                text: "**Valores tonales simplificados:**\n\n**3 valores b√°sicos:**\n1. **Luz** (blanco del papel)\n2. **Medio tono** (gris)\n3. **Sombra** (oscuro)\n\n**Regla de la bola:**\nImagina el cuerpo como esferas y cilindros.\n- Luz: donde golpea la fuente de luz\n- Medio: transici√≥n\n- Sombra: lado opuesto a la luz\n\n**Error com√∫n:** Sombrear sin estructura.\n\n**Soluci√≥n:** Define la estructura PRIMERO, sombrea DESPU√âS.\n\nPractica con objetos simples (huevos, botellas).",
                actions: ['Claro', 'Gracias']
            }
        },
        
        proyectoFinal: {
            keywords: ['proyecto final', 'final', 'proyecto', '1/4 mercurio'],
            responses: {
                text: "**Proyecto final - Requisitos:**\n\n- **Formato:** 1/4 pliego mercurio\n- **Tema:** Figura humana completa\n- **Incluir:**\n  * Gesto claro\n  * Estructura anat√≥mica\n  * Proporciones correctas\n  * Valores tonales b√°sicos\n\n**Proceso:**\n1. Sketch preliminar (varios intentos)\n2. Elige el mejor\n3. P√°salo al formato final\n4. Refina\n\n**Tiempo estimado:** 4-6 horas\n\nNo busques perfecci√≥n, busca aplicar TODO lo aprendido.",
                actions: ['¬øQu√© pose elijo?', 'Entendido']
            }
        },
        
        integracion: {
            keywords: ['integrar', 'integracion', 'todo junto', 'aplicar todo'],
            responses: {
                text: "**Integrar gesto + anatom√≠a:**\n\n**El truco:** Piensa en CAPAS, no en \"todo a la vez\".\n\n1. **Gesto primero** (30 seg)\n   - Captura la energ√≠a\n   - L√≠nea de acci√≥n\n\n2. **Estructura encima** (2 min)\n   - Cilindros y cajas\n   - Mant√©n el gesto\n\n3. **Anatom√≠a al final** (3+ min)\n   - M√∫sculos como \"bultos\" sobre estructura\n   - NO pierdas el gesto original\n\n**Secreto:** El gesto es el ALMA. La anatom√≠a es el TRAJE.\n\nNunca sacrifiques el gesto por anatom√≠a perfecta.",
                actions: ['Tiene sentido', 'OK']
            }
        },
        
        figura15min: {
            keywords: ['figura larga', '15 minutos', 'figura completa', 'tiempo largo'],
            responses: {
                text: "**Figura de 15 minutos - Distribuci√≥n:**\n\n- 1 min: L√≠nea de acci√≥n + composici√≥n\n- 3 min: Estructura (cilindros, masas)\n- 4 min: Anatom√≠a b√°sica\n- 4 min: Refinamiento de formas\n- 3 min: Valores/sombras b√°sicas\n\n**Tip:** Usa temporizador. Te fuerza a avanzar.\n\n**Error com√∫n:** Pasar 10 min en la cabeza y correr el resto.\n\n**Soluci√≥n:** Cronometra CADA fase.\n\nLa figura completa debe desarrollarse COMPLETA, no una parte perfecta.",
                actions: ['Voy a cronometrar', 'Entendido']
            }
        },

        // SISTEMA LMS (3 respuestas)
        subirEjercicios: {
            keywords: ['subir ejercicio', 'como subir', 'entregar', 'enviar trabajo'],
            responses: {
                text: "**C√≥mo subir ejercicios:**\n\n1. Ve a la lecci√≥n correspondiente\n2. Busca bot√≥n \"Subir ejercicio\"\n3. Saca foto CLARA de tu dibujo\n   - Buena luz\n   - Sin sombras\n   - Enfocado\n4. Sube la imagen\n5. ‚úì Confirmaci√≥n autom√°tica\n\n**Tip:** Puedes subir varias veces. Solo cuenta la √∫ltima versi√≥n.\n\nSi tienes problemas t√©cnicos, contacta al profesor.",
                actions: ['Entendido', 'Gracias']
            }
        },
        
        verProgreso: {
            keywords: ['progreso', 'avance', 'donde veo', 'estadisticas'],
            responses: {
                text: "**Ver tu progreso:**\n\n1. **Dashboard principal:** Barra de progreso general\n2. **Cada m√≥dulo:** Porcentaje completado\n3. **Dentro de lecciones:** Checkmarks ‚úì\n\n**Progreso se calcula por:**\n- Lecciones completadas\n- Ejercicios subidos\n- Evaluaciones aprobadas\n\n**Actualiza autom√°ticamente** cada vez que completas algo.\n\nNo te obsesiones con el %, obsesi√≥nate con PRACTICAR.",
                actions: ['OK', 'Claro']
            }
        },
        
        materiales: {
            keywords: ['materiales', 'que necesito', 'lapices', 'papel', 'herramientas'],
            responses: {
                text: "**Materiales b√°sicos:**\n\n**Esenciales:**\n- L√°piz grafito (HB y 2B)\n- Borrador\n- Papel (block de croquis)\n- Sacapuntas\n\n**Opcionales:**\n- Carboncillo\n- L√°pices de colores\n- Papel mercurio (proyecto final)\n\n**No necesitas:**\n- Materiales caros\n- 20 tipos de l√°pices\n- Papel fancy para practicar\n\n**Regla:** Mejor papel barato y MUCHA pr√°ctica, que papel caro y miedo a usarlo.",
                actions: ['Perfecto', 'Gracias']
            }
        }
    };

    // ============================================
    // 3. SISTEMA DE DETECCI√ìN INTELIGENTE
    // ============================================
    function detectEmotion(text) {
        const lowerText = text.toLowerCase();
        
        // Detectar emocional
        for (const [emotion, data] of Object.entries(emotionalKnowledge)) {
            for (const keyword of data.keywords) {
                if (lowerText.includes(keyword)) {
                    // Detectar intensidad si es frustraci√≥n
                    if (emotion === 'frustracion') {
                        const highIntensity = ['horrible', 'nunca', 'imposible', 'no puedo mas'].some(w => lowerText.includes(w));
                        const mediumIntensity = ['muy', 'mucho', 'demasiado'].some(w => lowerText.includes(w));
                        
                        if (highIntensity) return { emotion, intensity: 'alta' };
                        if (mediumIntensity) return { emotion, intensity: 'media' };
                        return { emotion, intensity: 'leve' };
                    }
                    return { emotion, intensity: null };
                }
            }
        }
        
        // Detectar t√©cnico
        for (const [topic, data] of Object.entries(technicalKnowledge)) {
            for (const keyword of data.keywords) {
                if (lowerText.includes(keyword)) {
                    return { topic, isTechnical: true };
                }
            }
        }
        
        return null;
    }

    // ============================================
    // 4. GENERADOR DE RESPUESTAS
    // ============================================
    function generateResponse(userMessage) {
        const detected = detectEmotion(userMessage);
        
        // Respuesta emocional
        if (detected && detected.emotion) {
            const emotionData = emotionalKnowledge[detected.emotion];
            
            if (detected.emotion === 'frustracion') {
                return emotionData.responses[detected.intensity];
            }
            
            return emotionData.responses;
        }
        
        // Respuesta t√©cnica
        if (detected && detected.isTechnical) {
            return technicalKnowledge[detected.topic].responses;
        }
        
        // Respuesta por defecto
        return {
            text: "Interesante pregunta ü§î. ¬øPodr√≠as darme m√°s detalles?\n\nPuedo ayudarte con:\n- üíô **Emociones** (frustraci√≥n, bloqueo, ansiedad)\n- üé® **T√©cnica** (gesto, anatom√≠a, proporciones)\n- üìö **Sistema** (c√≥mo usar el curso)\n\n¬øQu√© te gustar√≠a explorar?",
            actions: ['Tengo una duda t√©cnica', 'Me siento frustrado/a', 'Pregunta sobre el curso']
        };
    }

    // ============================================
    // 5. MEMORIA CONVERSACIONAL
    // ============================================
    class ConversationMemory {
        constructor() {
            this.history = [];
            this.emotionalState = [];
        }
        
        add(userMsg, botResponse, emotion, intensity) {
            this.history.push({
                user: userMsg,
                bot: botResponse,
                timestamp: new Date(),
                emotion,
                intensity
            });
            
            if (emotion) {
                this.emotionalState.push({ emotion, intensity, timestamp: new Date() });
            }
        }
        
        shouldOfferBreak() {
            // Si las √∫ltimas 3 interacciones tienen emociones negativas
            const recent = this.emotionalState.slice(-3);
            const negative = ['frustracion', 'ansiedad', 'bloqueo', 'llanto'];
            
            return recent.length >= 3 && recent.every(e => negative.includes(e.emotion));
        }
        
        getContextualGreeting() {
            if (this.history.length === 0) return null;
            
            const lastEmotion = this.emotionalState[this.emotionalState.length - 1];
            if (!lastEmotion) return null;
            
            const timeSince = Date.now() - lastEmotion.timestamp.getTime();
            const hoursSince = timeSince / (1000 * 60 * 60);
            
            if (hoursSince < 24) {
                return `Hey, te veo de vuelta üëã. ¬øC√≥mo te fue con lo que hablamos?\n\n¬øMejoraron las cosas o sigues con dudas?`;
            }
            
            return null;
        }
    }

    // ============================================
    // 6. EXPORTAR AL SCOPE GLOBAL
    // ============================================
    window.mentorKnowledge = {
        generateResponse,
        ConversationMemory,
        // Exportar knowledge para debugging (opcional)
        _emotional: emotionalKnowledge,
        _technical: technicalKnowledge
    };
    
    console.log('‚úÖ mentor-knowledge.js: Base de conocimiento cargada');
    console.log('üìä Respuestas emocionales:', Object.keys(emotionalKnowledge).length);
    console.log('üé® Respuestas t√©cnicas:', Object.keys(technicalKnowledge).length);

})();