<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Curso de Dibujo y Representaci√≥n del Cuerpo Humano - Universidad Alberto Hurtado">
    <meta name="author" content="Joselyn Vizcarra">
    <title>Curso de Dibujo Anat√≥mico - LMS UAH</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    
    <style>
        :root {
            --primary-dark: #2c5f66;
            --primary-light: #e8a2b8;
            --dark: #1a1a1a;
            --gray-light: #f5f5f5;
            --gray-medium: #666;
            --success: #4CAF50;
            --danger: #f44336;
            --warning: #FFC107;
            --info: #2196F3;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--gray-light);
            min-height: 100vh;
        }

        .header-uah {
            background: linear-gradient(135deg, var(--primary-dark), var(--dark));
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1030;
        }

        .user-badge {
            background: rgba(255,255,255,0.15);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            background: var(--primary-light);
            color: var(--dark);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .hero-section {
            background: linear-gradient(135deg, rgba(44,95,102,0.95), rgba(26,26,26,0.95));
            color: white;
            padding: 4rem 0 3rem;
            margin-bottom: 2rem;
        }

        .hero-title {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-light);
            margin-bottom: 1rem;
        }

        .hero-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 0;
        }

        .hero-icon {
            font-size: 6rem;
            opacity: 0.3;
        }

        /* ============================================
           NUEVO: ESTILOS PARA DASHBOARD DEL ESTUDIANTE
           ============================================ */
        .student-dashboard {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            margin-bottom: 3rem;
        }

        .dashboard-header {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary-light));
            color: white;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
        }

        .dashboard-header h3 {
            margin: 0;
            font-weight: 700;
            font-size: 1.5rem;
        }

        .progress-circle-container {
            text-align: center;
            padding: 2rem;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 12px;
        }

        .progress-circle {
            position: relative;
            width: 140px;
            height: 140px;
            margin: 0 auto;
        }

        .progress-circle svg {
            transform: rotate(-90deg);
        }

        .progress-circle-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-dark);
        }

        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .stat-box {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
            border: 2px solid var(--gray-light);
            transition: all 0.3s ease;
        }

        .stat-box:hover {
            border-color: var(--primary-light);
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .stat-box-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-dark);
            display: block;
            margin-bottom: 0.5rem;
        }

        .stat-box-label {
            font-size: 0.85rem;
            color: var(--gray-medium);
        }

        .next-task-card {
            background: linear-gradient(135deg, rgba(44,95,102,0.1), rgba(232,162,184,0.1));
            border-left: 4px solid var(--primary-dark);
            padding: 1.5rem;
            border-radius: 8px;
            margin-top: 2rem;
        }

        .next-task-card h6 {
            color: var(--primary-dark);
            margin-bottom: 0.75rem;
            font-weight: 600;
        }

        .next-task-card p {
            margin: 0;
            color: var(--dark);
        }

        .module-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .breakdown-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            border: 2px solid var(--gray-light);
            transition: all 0.3s ease;
        }

        .breakdown-card:hover {
            border-color: var(--primary-light);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .breakdown-card h6 {
            color: var(--primary-dark);
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .breakdown-progress {
            height: 8px;
            background: var(--gray-light);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.75rem;
        }

        .breakdown-progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .breakdown-stats {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: var(--gray-medium);
        }

        /* ============================================
           NUEVO: ALERTA DE EVALUACI√ìN DIAGN√ìSTICA
           ============================================ */
        .diagnostic-alert {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border-left: 4px solid var(--warning);
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: 0 4px 12px rgba(255,193,7,0.2);
        }

        .diagnostic-alert h5 {
            color: #856404;
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .diagnostic-alert p {
            color: #856404;
            margin-bottom: 1rem;
        }

        .btn-diagnostic {
            background: var(--warning);
            color: var(--dark);
            padding: 0.75rem 2rem;
            border-radius: 25px;
            border: none;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-diagnostic:hover {
            background: #e0a800;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255,193,7,0.4);
            color: var(--dark);
        }

        /* Estilos originales contin√∫an... */
        .progress-card {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            margin-bottom: 3rem;
        }

        .progress-header {
            color: var(--primary-dark);
            font-weight: 600;
            margin-bottom: 1.5rem;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .stat-badge {
            background: var(--gray-light);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            color: var(--primary-dark);
            font-weight: 500;
            display: inline-block;
        }

        .custom-progress {
            height: 35px;
            background: var(--gray-light);
            border-radius: 20px;
            overflow: hidden;
            position: relative;
        }

        .custom-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-dark), var(--primary-light));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.95rem;
            transition: width 0.6s ease;
            border-radius: 20px;
        }

        .module-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .module-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .module-header {
            background: linear-gradient(135deg, var(--primary-dark), var(--dark));
            color: white;
            padding: 2rem 1.5rem;
            position: relative;
        }

        .module-number {
            position: absolute;
            top: 0.75rem;
            right: 1.5rem;
            font-size: 3rem;
            opacity: 0.2;
            font-weight: bold;
            line-height: 1;
        }

        .module-title {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .module-subtitle {
            font-size: 0.95rem;
            opacity: 0.85;
        }

        .module-body {
            padding: 1.5rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .module-description {
            color: var(--gray-medium);
            margin-bottom: 1.25rem;
            line-height: 1.6;
            flex-grow: 1;
        }

        .module-meta {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.25rem;
            flex-wrap: wrap;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.85rem;
            color: var(--gray-medium);
        }

        .module-progress-container {
            margin-bottom: 1.25rem;
        }

        .module-progress-bar {
            height: 8px;
            background: var(--gray-light);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .module-progress-fill {
            height: 100%;
            background: var(--success);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .progress-label {
            font-size: 0.8rem;
            color: var(--gray-medium);
            text-align: right;
        }

        .module-actions {
            display: flex;
            gap: 0.75rem;
        }

        .btn-module {
            flex: 1;
            padding: 0.75rem 1rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            text-align: center;
            display: inline-block;
            font-size: 0.9rem;
        }

        .btn-module:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .btn-primary-custom {
            background: var(--primary-dark);
            color: white;
        }

        .btn-primary-custom:hover:not(:disabled) {
            background: var(--primary-light);
            color: var(--dark);
        }

        .btn-secondary-custom {
            background: var(--gray-light);
            color: var(--primary-dark);
            border: 2px solid var(--primary-light);
        }

        .btn-secondary-custom:hover:not(:disabled) {
            background: var(--primary-light);
            color: white;
            border-color: var(--primary-light);
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .loading-overlay.show {
            display: flex;
        }

        .loading-content {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .spinner-border-custom {
            width: 3rem;
            height: 3rem;
            border: 4px solid var(--gray-light);
            border-top-color: var(--primary-dark);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in-up {
            animation: fadeInUp 0.6s ease-out;
        }

        .info-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            margin-bottom: 2rem;
        }

        .info-card h5 {
            color: var(--primary-dark);
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .info-list {
            list-style: none;
            padding: 0;
        }

        .info-list li {
            padding: 0.5rem 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .info-list li i {
            color: var(--primary-light);
            font-size: 1.1rem;
        }

        footer {
            background: var(--dark);
            color: white;
            padding: 2rem 0;
            margin-top: 4rem;
        }

        @media (max-width: 768px) {
            .hero-title {
                font-size: 1.8rem;
            }

            .hero-subtitle {
                font-size: 1rem;
            }

            .module-number {
                font-size: 2rem;
            }

            .module-actions {
                flex-direction: column;
            }

            .btn-module {
                width: 100%;
            }

            .dashboard-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .module-breakdown {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
    <body>
    <script src="auth.js"></script>

    <header class="header-uah">
        <div class="container-fluid">
            <div class="row align-items-center g-3">
                <div class="col-md-4">
                    <h1 class="h5 mb-0 d-flex align-items-center gap-2">
                        <i class="bi bi-palette"></i>
                        <span style="color: var(--primary-light);">Arte & Anatom√≠a UAH</span>
                    </h1>
                </div>
                <div class="col-md-4 text-center d-none d-md-block">
                    <span class="text-white-50 small">Pedagog√≠a en Artes Visuales</span>
                </div>
                <div class="col-md-4">
                    <div class="d-flex justify-content-end align-items-center gap-2">
                        <div class="user-badge">
                            <div class="user-avatar" id="userAvatar">U</div>
                            <div class="d-none d-lg-block">
                                <div class="fw-bold small" id="userName">Cargando...</div>
                                <div class="small opacity-75" id="userRole" style="font-size: 0.75rem;">...</div>
                            </div>
                        </div>
                        <button class="btn btn-sm btn-outline-light d-none" id="dashboardBtn" onclick="goToDashboard()">
                            <i class="bi bi-speedometer2"></i>
                            <span class="d-none d-lg-inline ms-1">Dashboard</span>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="logout()">
                            <i class="bi bi-box-arrow-right"></i>
                            <span class="d-none d-md-inline ms-1">Salir</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main>
        <div class="loading-overlay" id="loadingOverlay">
            <div class="loading-content">
                <div class="spinner-border-custom mb-3"></div>
                <p class="mb-0">Cargando curso...</p>
            </div>
        </div>

        <section class="hero-section">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-8 fade-in-up">
                        <h1 class="hero-title">Dibujo y Representaci√≥n del Cuerpo Humano</h1>
                        <p class="hero-subtitle">Desarrolla competencias t√©cnicas y expresivas en dibujo de figura humana mediante pr√°ctica sistem√°tica progresiva</p>
                    </div>
                    <div class="col-lg-4 text-center d-none d-lg-block">
                        <i class="bi bi-easel hero-icon"></i>
                    </div>
                </div>
            </div>
        </section>

        <div class="container">
            <!-- ============================================
                 NUEVO: ALERTA DE EVALUACI√ìN DIAGN√ìSTICA
                 ============================================ -->
            <div class="diagnostic-alert fade-in-up" id="diagnosticAlert" style="display: none;">
                <h5>
                    <i class="bi bi-clipboard-check"></i>
                    ¬°Comienza con una Evaluaci√≥n Diagn√≥stica!
                </h5>
                <p class="mb-3">
                    Antes de empezar el curso, ay√∫danos a conocer tu nivel inicial. 
                    Esto nos permitir√° personalizar tu experiencia de aprendizaje.
                </p>
                <a href="diagnostic.html" class="btn-diagnostic">
                    <i class="bi bi-play-fill me-2"></i>Realizar Evaluaci√≥n (5 min)
                </a>
            </div>

            <!-- ============================================
                 NUEVO: DASHBOARD PERSONAL DEL ESTUDIANTE
                 ============================================ -->
            <div class="student-dashboard fade-in-up" id="studentDashboard" style="display: none;">
                <div class="dashboard-header">
                    <h3>
                        <i class="bi bi-graph-up me-2"></i>
                        Tu Progreso Personal
                    </h3>
                </div>

                <div class="row g-4">
                    <!-- C√≠rculo de progreso -->
                    <div class="col-md-4">
                        <div class="progress-circle-container">
                            <div class="progress-circle">
                                <svg width="140" height="140">
                                    <circle cx="70" cy="70" r="60" fill="none" stroke="#e9ecef" stroke-width="12"/>
                                    <circle id="progressCircle" cx="70" cy="70" r="60" fill="none" 
                                            stroke="var(--primary-dark)" stroke-width="12" 
                                            stroke-linecap="round" 
                                            stroke-dasharray="377" 
                                            stroke-dashoffset="377"
                                            transform="rotate(-90 70 70)"
                                            style="transition: stroke-dashoffset 0.8s ease;"/>
                                </svg>
                                <div class="progress-circle-text" id="progressPercentText">0%</div>
                            </div>
                            <h6 class="mt-3 mb-0">Progreso Total</h6>
                        </div>
                    </div>

                    <!-- Estad√≠sticas -->
                    <div class="col-md-8">
                        <div class="dashboard-stats">
                            <div class="stat-box">
                                <span class="stat-box-number" id="studentModulesCompleted">0</span>
                                <span class="stat-box-label">M√≥dulos Completados</span>
                            </div>
                            <div class="stat-box">
                                <span class="stat-box-number" id="studentLessonsCompleted">0</span>
                                <span class="stat-box-label">Lecciones Completadas</span>
                            </div>
                            <div class="stat-box">
                                <span class="stat-box-number" id="studentEvaluationsPassed">0</span>
                                <span class="stat-box-label">Evaluaciones Aprobadas</span>
                            </div>
                            <div class="stat-box">
                                <span class="stat-box-number" id="studentExercises">0</span>
                                <span class="stat-box-label">Ejercicios Realizados</span>
                            </div>
                        </div>

                        <!-- Pr√≥xima tarea -->
                        <div class="next-task-card">
                            <h6>
                                <i class="bi bi-arrow-right-circle me-2"></i>
                                Pr√≥xima Tarea
                            </h6>
                            <p id="nextTaskText">Cargando...</p>
                        </div>
                    </div>
                </div>

                <!-- Desglose por m√≥dulo -->
                <div class="mt-4">
                    <h5 class="mb-3" style="color: var(--primary-dark); font-weight: 600;">
                        <i class="bi bi-list-check me-2"></i>
                        Desglose por M√≥dulo
                    </h5>
                    <div class="module-breakdown" id="moduleBreakdown"></div>
                </div>
            </div>

            <!-- Barra de progreso original (simplificada) -->
            <div class="progress-card fade-in-up" id="simpleProgressCard">
                <h3 class="progress-header">
                    <i class="bi bi-graph-up"></i>
                    Tu Progreso General
                </h3>
                <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2">
                    <span class="stat-badge">
                        <strong id="completedModules">0</strong> de 3 m√≥dulos completados
                    </span>
                    <span class="stat-badge">
                        <i class="bi bi-clock"></i> 12-14 horas totales
                    </span>
                    <span class="stat-badge">
                        <i class="bi bi-calendar3"></i> 12 d√≠as de curso
                    </span>
                </div>
                <div class="custom-progress">
                    <div class="custom-progress-bar" id="progressBar" style="width: 0%">
                        <span>0%</span>
                    </div>
                </div>
                <div class="mt-2 text-end">
                    <small class="text-muted" id="progressDetails">Comienza tu primera lecci√≥n para ver tu progreso</small>
                </div>
            </div>

            <div class="row mb-4">
                <div class="col-md-6 fade-in-up">
                    <div class="info-card">
                        <h5><i class="bi bi-trophy me-2"></i>Objetivos del Curso</h5>
                        <ul class="info-list">
                            <li><i class="bi bi-check-circle-fill"></i> Aplicar t√©cnicas de observaci√≥n directa</li>
                            <li><i class="bi bi-check-circle-fill"></i> Analizar estructura anat√≥mica b√°sica</li>
                            <li><i class="bi bi-check-circle-fill"></i> Crear representaci√≥n completa de figura humana</li>
                        </ul>
                    </div>
                </div>
                <div class="col-md-6 fade-in-up">
                    <div class="info-card">
                        <h5><i class="bi bi-clipboard-check me-2"></i>Entregables Totales</h5>
                        <ul class="info-list">
                            <li><i class="bi bi-pencil"></i> 23 dibujos progresivos</li>
                            <li><i class="bi bi-list-check"></i> 10 evaluaciones formativas</li>
                            <li><i class="bi bi-star-fill"></i> 1 proyecto final (1/4 mercurio)</li>
                        </ul>
                    </div>
                </div>
            </div>

            <section class="mb-5">
                <h2 class="mb-4" style="color: var(--primary-dark); font-weight: 600;">
                    <i class="bi bi-book"></i> M√≥dulos del Curso
                </h2>
                
                <div class="row g-4" id="modulesGrid"></div>
            </section>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                    <p class="mb-1">&copy; 2025 Universidad Alberto Hurtado</p>
                    <p class="mb-0 small text-white-50">Pedagog√≠a en Artes Visuales</p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <p class="mb-1">Desarrollado por Joselyn Vizcarra</p>
                    <p class="mb-0 small text-white-50">Diplomado en Dise√±o Instruccional - U. de Chile</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        const modulesData = [
            {
                id: 1,
                number: "01",
                title: "Observaci√≥n y Gesto",
                subtitle: "Captura de movimiento y proporci√≥n",
                description: "Domina t√©cnicas de observaci√≥n directa para capturar l√≠nea de acci√≥n en croquis de 2-5 minutos. Aprende a medir proporciones visualmente y comprender el balance corporal.",
                duration: "3 d√≠as",
                lessons: 3,
                exercises: "8 croquis",
                evaluations: "3 evaluaciones",
                hours: "2.5 horas",
                difficulty: "B√°sico",
                url: "module1.html",
                available: true
            },
            {
                id: 2,
                number: "02",
                title: "Anatom√≠a Funcional",
                subtitle: "Estructura √≥sea y muscular",
                description: "Identifica las 3 masas principales del cuerpo y 6 grupos musculares esenciales. Analiza la estructura de manos, pies y proporciones faciales.",
                duration: "4 d√≠as",
                lessons: 4,
                exercises: "12 estudios",
                evaluations: "4 evaluaciones",
                hours: "3.3 horas",difficulty: "Intermedio",
                url: "module2.html",
                available: true
            },
            {
                id: 3,
                number: "03",
                title: "Figura Completa",
                subtitle: "Integraci√≥n y proyecto final",
                description: "Integra gesto + anatom√≠a en figuras completas. Aplica luz, sombra y volumen. Crea tu proyecto final en formato 1/4 mercurio.",
                duration: "5 d√≠as",
                lessons: 3,
                exercises: "3 figuras + proyecto",
                evaluations: "3 evaluaciones",
                hours: "5-6 horas",
                difficulty: "Avanzado",
                url: "module3.html",
                available: true
            }
        ];

        function isAuthenticated() {
            return localStorage.getItem('isAuthenticated') === 'true';
        }

        function getCurrentUser() {
            if (!isAuthenticated()) return null;
            try {
                return JSON.parse(localStorage.getItem('currentUser') || 'null');
            } catch (error) {
                console.error('Error parsing user data:', error);
                return null;
            }
        }

        function logout() {
            saveProgress();
            localStorage.removeItem('currentUser');
            localStorage.removeItem('isAuthenticated');
            localStorage.removeItem('sessionStart');
            window.location.href = 'login.html';
        }

        function checkAuthentication() {
            if (!isAuthenticated()) {
                window.location.href = 'login.html';
                return false;
            }
            return true;
        }

        function getStudentProgress() {
            const currentUser = getCurrentUser();
            if (!currentUser) return null;
            
            const progressKey = `progress_${currentUser.email || currentUser.username}`;
            try {
                const progress = JSON.parse(localStorage.getItem(progressKey) || 'null');
                if (!progress) {
                    return initializeProgress();
                }
                return progress;
            } catch (error) {
                console.error('Error parsing progress data:', error);
                return initializeProgress();
            }
        }

        function initializeProgress() {
            return {
                modules: {
                    1: { completed: false, progress: 0, timeSpent: 0, completedLessons: [] },
                    2: { completed: false, progress: 0, timeSpent: 0, completedLessons: [] },
                    3: { completed: false, progress: 0, timeSpent: 0, completedLessons: [] }
                },
                overallProgress: 0,
                totalTimeSpent: 0,
                lastActivity: new Date().toISOString()
            };
        }

        function saveProgress() {
            const currentUser = getCurrentUser();
            if (!currentUser) return;
            
            const progressKey = `progress_${currentUser.email || currentUser.username}`;
            const progress = getStudentProgress();
            
            if (progress) {
                progress.lastActivity = new Date().toISOString();
                localStorage.setItem(progressKey, JSON.stringify(progress));
            }
        }

        function calculateOverallProgress() {
            const progress = getStudentProgress();
            if (!progress) return 0;
            
            let totalProgress = 0;
            let moduleCount = 0;
            
            for (let moduleId in progress.modules) {
                totalProgress += progress.modules[moduleId].progress || 0;
                moduleCount++;
            }
            
            return moduleCount > 0 ? Math.round(totalProgress / moduleCount) : 0;
        }

        function countCompletedModules() {
            const progress = getStudentProgress();
            if (!progress) return 0;
            
            let completed = 0;
            for (let moduleId in progress.modules) {
                if (progress.modules[moduleId].completed) {
                    completed++;
                }
            }
            return completed;
        }

        function updateUserInterface() {
            const currentUser = getCurrentUser();
            if (!currentUser) return;

            document.getElementById('userName').textContent = 
                currentUser.fullName || currentUser.name || currentUser.username || 'Usuario';
            
            document.getElementById('userRole').textContent = 
                getRoleDisplayName(currentUser.role);

            const avatar = document.getElementById('userAvatar');
            if (avatar) {
                avatar.textContent = (currentUser.fullName || currentUser.name || currentUser.username).charAt(0).toUpperCase();
            }

            const dashboardBtn = document.getElementById('dashboardBtn');
            if (currentUser.role === 'instructor' || currentUser.role === 'profesor') {
                dashboardBtn.classList.remove('d-none');
            }

            updateProgress();
            
            // ============================================
            // NUEVO: Verificar y mostrar elementos seg√∫n estado
            // ============================================
            checkDiagnosticStatus();
            loadStudentDashboard();
        }

        function getRoleDisplayName(role) {
            const roles = {
                'instructor': 'Instructor',
                'profesor': 'Profesor',
                'estudiante': 'Estudiante',
                'evaluador': 'Evaluador',
                'visitante': 'Visitante'
            };
            return roles[role] || 'Usuario';
        }

        // ============================================
        // NUEVA FUNCI√ìN: Verificar estado de evaluaci√≥n diagn√≥stica
        // ============================================
        function checkDiagnosticStatus() {
            const currentUser = getCurrentUser();
            if (!currentUser) return;

            // Solo mostrar alerta a estudiantes
            if (currentUser.role === 'instructor' || currentUser.role === 'profesor') {
                return;
            }

            const diagnosticCompleted = localStorage.getItem('student_diagnostic');
            const diagnosticAlert = document.getElementById('diagnosticAlert');
            const studentDashboard = document.getElementById('studentDashboard');
            const simpleProgressCard = document.getElementById('simpleProgressCard');

            if (!diagnosticCompleted) {
                // No ha completado diagn√≥stica: mostrar alerta
                diagnosticAlert.style.display = 'block';
                studentDashboard.style.display = 'none';
                simpleProgressCard.style.display = 'block';
            } else {
                // Ya complet√≥ diagn√≥stica: mostrar dashboard completo
                diagnosticAlert.style.display = 'none';
                studentDashboard.style.display = 'block';
                simpleProgressCard.style.display = 'none';
            }
        }

        // ============================================
        // NUEVA FUNCI√ìN: Cargar dashboard personalizado del estudiante
        // ============================================
        function loadStudentDashboard() {
            const currentUser = getCurrentUser();
            if (!currentUser || currentUser.role === 'instructor' || currentUser.role === 'profesor') {
                return;
            }

            const diagnosticCompleted = localStorage.getItem('student_diagnostic');
            if (!diagnosticCompleted) return;

            // Recopilar datos de todos los m√≥dulos
            const modules = [1, 2, 3];
            let totalLessons = 0;
            let completedLessons = 0;
            let passedEvaluations = 0;
            let completedModules = 0;

            const moduleDetails = modules.map(moduleNum => {
                const key = `module${moduleNum}_progress`;
                const saved = localStorage.getItem(key);
                
                if (saved) {
                    try {
                        const data = JSON.parse(saved);
                        const completed = data.completedLessons || [];
                        const evaluations = data.evaluations || {};
                        
                        const moduleLessons = moduleNum === 1 ? 3 : moduleNum === 2 ? 4 : 3;
                        totalLessons += moduleLessons;
                        completedLessons += completed.length;
                        
                        // Contar evaluaciones aprobadas (m√≠nimo 2/3 respuestas correctas)
                        Object.values(evaluations).forEach(evalData => {
                            if (Object.keys(evalData).length >= 2) passedEvaluations++;
                        });
                        
                        const moduleCompleted = completed.length === moduleLessons;
                        if (moduleCompleted) completedModules++;
                        
                        return {
                            num: moduleNum,
                            name: modulesData[moduleNum - 1].title,
                            completed: completed.length,
                            total: moduleLessons,
                            percentage: Math.round((completed.length / moduleLessons) * 100),
                            status: moduleCompleted ? 'completed' : completed.length > 0 ? 'in-progress' : 'not-started'
                        };
                    } catch (e) {
                        return null;
                    }
                }
                return {
                    num: moduleNum,
                    name: modulesData[moduleNum - 1].title,
                    completed: 0,
                    total: moduleNum === 1 ? 3 : moduleNum === 2 ? 4 : 3,
                    percentage: 0,
                    status: 'not-started'
                };
            }).filter(Boolean);

            // Actualizar estad√≠sticas principales
            const overallProgress = totalLessons > 0 ? Math.round((completedLessons / totalLessons) * 100) : 0;
            
            document.getElementById('studentModulesCompleted').textContent = completedModules;
            document.getElementById('studentLessonsCompleted').textContent = completedLessons;
            document.getElementById('studentEvaluationsPassed').textContent = passedEvaluations;
            document.getElementById('studentExercises').textContent = completedLessons * 3; // Estimado: 3 ejercicios por lecci√≥n
            
            // Actualizar c√≠rculo de progreso
            const circumference = 377; // 2 * PI * 60
            const offset = circumference - (circumference * overallProgress / 100);
            const progressCircle = document.getElementById('progressCircle');
            if (progressCircle) {
                progressCircle.style.strokeDashoffset = offset;
            }
            document.getElementById('progressPercentText').textContent = overallProgress + '%';
            
            // Determinar pr√≥xima tarea
            let nextTask = 'Comenzar M√≥dulo 1 - Lecci√≥n 1.1';
            if (completedLessons === 0) {
                nextTask = 'Comenzar M√≥dulo 1 - Lecci√≥n 1.1: Fundamentos del Croquis';
            } else if (completedModules === 3) {
                nextTask = '¬°Has completado todo el curso! üéâ Puedes repasar cualquier m√≥dulo.';
            } else {
                const currentModule = moduleDetails.find(m => m.status === 'in-progress');
                if (currentModule) {
                    nextTask = `Continuar ${currentModule.name} - Lecci√≥n ${currentModule.completed + 1}`;
                } else {
                    const nextModule = moduleDetails.find(m => m.status === 'not-started');
                    if (nextModule) {
                        nextTask = `Comenzar ${nextModule.name} - Lecci√≥n 1`;
                    }
                }
            }
            document.getElementById('nextTaskText').textContent = nextTask;
            
            // Generar desglose por m√≥dulo
            const breakdown = document.getElementById('moduleBreakdown');
            if (breakdown) {
                breakdown.innerHTML = moduleDetails.map(m => {
                    const statusConfig = {
                        'completed': { color: 'success', icon: 'check-circle-fill', label: 'Completado' },
                        'in-progress': { color: 'warning', icon: 'clock-fill', label: 'En progreso' },
                        'not-started': { color: 'secondary', icon: 'circle', label: 'No iniciado' }
                    };
                    const config = statusConfig[m.status];
                    
                    return `
                        <div class="breakdown-card">
                            <h6>
                                <i class="bi bi-${config.icon} me-2" style="color: var(--${config.color});"></i>
                                M√≥dulo ${m.num}: ${m.name}
                            </h6>
                            <div class="breakdown-progress">
                                <div class="breakdown-progress-fill" 
                                     style="width: ${m.percentage}%; background: var(--${config.color});"></div>
                            </div>
                            <div class="breakdown-stats">
                                <span>${m.completed}/${m.total} lecciones</span>
                                <span class="badge bg-${config.color}">${config.label}</span>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        }

        function updateProgress() {
            const overallProgress = calculateOverallProgress();
            const completedModules = countCompletedModules();
            
            document.getElementById('completedModules').textContent = completedModules;
            
            const progressBar = document.getElementById('progressBar');
            if (progressBar) {
                progressBar.style.width = `${overallProgress}%`;
                const span = progressBar.querySelector('span');
                if (span) span.textContent = `${overallProgress}%`;
            }

            const progressDetails = document.getElementById('progressDetails');
            if (progressDetails) {
                if (overallProgress === 0) {
                    progressDetails.textContent = 'Comienza tu primera lecci√≥n para ver tu progreso';
                } else if (overallProgress === 100) {
                    progressDetails.textContent = '¬°Felicitaciones! Has completado todos los m√≥dulos';
                } else {
                    progressDetails.textContent = `Has avanzado ${overallProgress}% del curso total`;
                }
            }
        }

        function loadModules() {
            const grid = document.getElementById('modulesGrid');
            const progress = getStudentProgress();
            
            grid.innerHTML = '';
            
            modulesData.forEach(module => {
                const moduleProgress = progress ? 
                    (progress.modules[module.id] || {}) : {};
                
                const card = createModuleCard(module, moduleProgress);
                grid.appendChild(card);
            });
        }

        function createModuleCard(module, moduleProgress) {
            const col = document.createElement('div');
            col.className = 'col-lg-4 col-md-6 fade-in-up';

            const progressValue = moduleProgress.progress || 0;
            const isCompleted = moduleProgress.completed || false;

            let actionButton = '';
            if (isCompleted) {
                actionButton = `<a href="${module.url}" class="btn-module btn-secondary-custom"><i class="bi bi-check-circle-fill me-2"></i>Repasar</a>`;
            } else if (progressValue > 0) {
                actionButton = `<a href="${module.url}" class="btn-module btn-primary-custom"><i class="bi bi-play-circle me-2"></i>Continuar</a>`;
            } else {
                actionButton = `<a href="${module.url}" class="btn-module btn-primary-custom"><i class="bi bi-play-circle me-2"></i>Comenzar</a>`;
            }

            col.innerHTML = `
                <div class="module-card">
                    <div class="module-header">
                        <span class="module-number">${module.number}</span>
                        <h3 class="module-title">${module.title}</h3>
                        <p class="module-subtitle">${module.subtitle}</p>
                    </div>
                    <div class="module-body">
                        <p class="module-description">${module.description}</p>
                        <div class="module-meta">
                            <span class="meta-item">
                                <i class="bi bi-calendar3"></i>
                                ${module.duration}
                            </span>
                            <span class="meta-item">
                                <i class="bi bi-book"></i>
                                ${module.lessons} lecciones
                            </span>
                            <span class="meta-item">
                                <i class="bi bi-clock"></i>
                                ${module.hours}
                            </span>
                        </div>
                        <div class="module-meta">
                            <span class="meta-item">
                                <i class="bi bi-pencil"></i>
                                ${module.exercises}
                            </span>
                            <span class="meta-item">
                                <i class="bi bi-clipboard-check"></i>
                                ${module.evaluations}
                            </span>
                            <span class="meta-item">
                                <i class="bi bi-bar-chart"></i>
                                ${module.difficulty}
                            </span>
                        </div>
                        <div class="module-progress-container">
                            <div class="module-progress-bar">
                                <div class="module-progress-fill" style="width: ${progressValue}%"></div>
                            </div>
                            <div class="progress-label">${progressValue}% completado</div>
                        </div>
                        <div class="module-actions">
                            ${actionButton}
                        </div>
                    </div>
                </div>
            `;

            return col;
        }

        function goToDashboard() {
            window.location.href = 'dashboard.html';
        }

        function showLoading(show) {
            const loadingOverlay = document.getElementById('loadingOverlay');
            if (show) {
                loadingOverlay.classList.add('show');
            } else {
                loadingOverlay.classList.remove('show');
            }
        }

        // ============================================
        // INICIALIZACI√ìN
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üé® Inicializando LMS...');
            
            if (!checkAuthentication()) {
                return;
            }

            showLoading(true);

            setTimeout(() => {
                updateUserInterface();
                loadModules();
                showLoading(false);
                console.log('‚úÖ LMS inicializado correctamente');
            }, 500);
        });

        window.addEventListener('beforeunload', function() {
            saveProgress();
        });

        // Auto-guardar progreso cada 2 minutos
        setInterval(saveProgress, 120000);
    </script>
</body><!-- ============================================
     MENTOR ANAT√ìMICO - TODO EN UNO
     Pega este c√≥digo ANTES del </body> en index.html
     ============================================ -->

<style>
/* ========== ESTILOS DEL MENTOR ========== */
:root {
    --mentor-primary-dark: #2c5f66;
    --mentor-primary-light: #e8a2b8;
    --mentor-dark: #1a1a1a;
    --mentor-success: #4CAF50;
    --mentor-bg-light: #f8f9fa;
}

.mentor-floating-btn {
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    width: 65px;
    height: 65px;
    background: linear-gradient(135deg, var(--mentor-primary-dark), var(--mentor-dark));
    color: white;
    border: none;
    border-radius: 50%;
    font-size: 2rem;
    box-shadow: 0 4px 20px rgba(44, 95, 102, 0.5);
    cursor: pointer;
    z-index: 9997;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    animation: mentor-pulse 3s infinite;
}

.mentor-floating-btn:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 30px rgba(44, 95, 102, 0.7);
}

@keyframes mentor-pulse {
    0%, 100% { box-shadow: 0 4px 20px rgba(44, 95, 102, 0.5); }
    50% { box-shadow: 0 4px 30px rgba(44, 95, 102, 0.8); }
}

.mentor-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 9998;
    display: none;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.mentor-overlay.active {
    display: flex;
    opacity: 1;
}

.mentor-backdrop {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(3px);
}

.mentor-container {
    position: absolute;
    bottom: 6rem;
    right: 2rem;
    width: 420px;
    height: 600px;
    background: white;
    border-radius: 20px;
    box-shadow: 0 10px 50px rgba(0, 0, 0, 0.3);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    animation: mentor-slide-up 0.3s ease;
}

@keyframes mentor-slide-up {
    from {
        transform: translateY(20px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.mentor-header {
    background: linear-gradient(135deg, var(--mentor-primary-dark), var(--mentor-dark));
    color: white;
    padding: 1rem 1.25rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.mentor-header-info {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.mentor-avatar {
    width: 40px;
    height: 40px;
    background: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
}

.mentor-header-text h3 {
    font-size: 1rem;
    font-weight: 600;
    margin: 0 0 0.25rem 0;
}

.mentor-status {
    font-size: 0.8rem;
    opacity: 0.9;
    display: flex;
    align-items: center;
    gap: 0.4rem;
}

.mentor-status-dot {
    width: 7px;
    height: 7px;
    background: var(--mentor-success);
    border-radius: 50%;
    animation: mentor-status-pulse 2s infinite;
}

@keyframes mentor-status-pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

.mentor-btn-icon {
    width: 32px;
    height: 32px;
    background: rgba(255,255,255,0.2);
    border: none;
    border-radius: 50%;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
}

.mentor-btn-icon:hover {
    background: rgba(255,255,255,0.3);
    transform: scale(1.1);
}

.mentor-messages {
    flex: 1;
    overflow-y: auto;
    padding: 1rem;
    background: var(--mentor-bg-light);
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.mentor-messages::-webkit-scrollbar {
    width: 6px;
}

.mentor-messages::-webkit-scrollbar-thumb {
    background: var(--mentor-primary-light);
    border-radius: 10px;
}

.mentor-message {
    display: flex;
    gap: 0.5rem;
    animation: mentor-message-slide 0.3s ease;
}

@keyframes mentor-message-slide {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.mentor-message.user {
    flex-direction: row-reverse;
}

.mentor-message-avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.1rem;
    flex-shrink: 0;
}

.mentor-message.bot .mentor-message-avatar {
    background: var(--mentor-primary-dark);
    color: white;
}

.mentor-message.user .mentor-message-avatar {
    background: var(--mentor-primary-light);
    color: var(--mentor-dark);
}

.mentor-message-content {
    max-width: 75%;
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

.mentor-message-bubble {
    padding: 0.875rem 1rem;
    border-radius: 15px;
    line-height: 1.5;
    font-size: 0.9rem;
}

.mentor-message.bot .mentor-message-bubble {
    background: var(--mentor-primary-dark);
    color: white;
    border-bottom-left-radius: 4px;
}

.mentor-message.user .mentor-message-bubble {
    background: var(--mentor-primary-light);
    color: var(--mentor-dark);
    border-bottom-right-radius: 4px;
}

.mentor-message-bubble h4 {
    font-size: 1rem;
    margin: 0 0 0.5rem 0;
    font-weight: 600;
}

.mentor-message-bubble p {
    margin: 0.5rem 0;
}

.mentor-message-bubble strong {
    font-weight: 600;
}

.mentor-message-time {
    font-size: 0.7rem;
    opacity: 0.7;
    align-self: flex-end;
}

.mentor-message.user .mentor-message-time {
    align-self: flex-start;
}

.mentor-quick-actions {
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem;
    margin-top: 0.5rem;
}

.mentor-quick-btn {
    background: rgba(255,255,255,0.2);
    border: 1px solid rgba(255,255,255,0.3);
    color: white;
    padding: 0.4rem 0.75rem;
    border-radius: 12px;
    font-size: 0.75rem;
    cursor: pointer;
    transition: all 0.3s;
}

.mentor-quick-btn:hover {
    background: rgba(255,255,255,0.3);
    transform: translateY(-1px);
}

.mentor-typing {
    display: none;
    align-items: center;
    gap: 0.5rem;
    padding: 0 1rem 0.5rem 1rem;
}

.mentor-typing.active {
    display: flex;
}

.mentor-typing-dots {
    background: var(--mentor-primary-dark);
    padding: 0.75rem 1rem;
    border-radius: 15px;
    display: flex;
    gap: 0.4rem;
}

.mentor-typing-dot {
    width: 7px;
    height: 7px;
    background: white;
    border-radius: 50%;
    animation: mentor-typing-bounce 1.4s infinite;
}

.mentor-typing-dot:nth-child(2) { animation-delay: 0.2s; }
.mentor-typing-dot:nth-child(3) { animation-delay: 0.4s; }

@keyframes mentor-typing-bounce {
    0%, 60%, 100% { opacity: 0.3; transform: scale(0.8); }
    30% { opacity: 1; transform: scale(1.2); }
}

.mentor-input-area {
    padding: 1rem;
    background: white;
    border-top: 2px solid #e0e7ff;
}

.mentor-input-wrapper {
    display: flex;
    gap: 0.5rem;
    align-items: flex-end;
}

.mentor-input {
    flex: 1;
    padding: 0.75rem 1rem;
    border: 2px solid var(--mentor-primary-light);
    border-radius: 18px;
    font-size: 0.9rem;
    resize: none;
    max-height: 100px;
    background: white;
    color: var(--mentor-dark);
    font-family: inherit;
    transition: all 0.3s;
}

.mentor-input:focus {
    outline: none;
    border-color: var(--mentor-primary-dark);
    box-shadow: 0 0 0 3px rgba(44, 95, 102, 0.1);
}

.mentor-btn-send {
    width: 40px;
    height: 40px;
    background: var(--mentor-primary-dark);
    color: white;
    border: none;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s;
    font-size: 1.1rem;
}

.mentor-btn-send:hover {
    background: var(--mentor-primary-light);
    color: var(--mentor-dark);
    transform: scale(1.1);
}

.mentor-welcome {
    text-align: center;
    padding: 2rem 1.5rem;
    color: #666;
}

.mentor-welcome-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
}

.mentor-welcome h3 {
    font-size: 1.2rem;
    margin-bottom: 0.5rem;
    color: var(--mentor-dark);
}

.mentor-welcome p {
    font-size: 0.9rem;
    line-height: 1.6;
}

@media (max-width: 768px) {
    .mentor-container {
        bottom: 0;
        right: 0;
        width: 100%;
        height: 100vh;
        border-radius: 0;
    }
    
    .mentor-floating-btn {
        bottom: 1.5rem;
        right: 1.5rem;
        width: 60px;
        height: 60px;
        font-size: 1.8rem;
    }
}
</style>

<script>
// ========== MENTOR ANAT√ìMICO - SISTEMA COMPLETO ==========
(function() {
    'use strict';
    
    console.log('ü§ñ Mentor Anat√≥mico: Inicializando...');
    
    // Base de conocimiento
    // ============================================
// BASE DE CONOCIMIENTO COMPLETA DEL MENTOR
// Reemplaza la secci√≥n "const knowledge = {...}" 
// en tu c√≥digo actual con ESTO
// ============================================

const knowledge = {
    // ========== CONVERSACI√ìN CASUAL ==========
    greetings: {
        keywords: ['hola', 'hey', 'buenos d√≠as', 'buenas tardes', 'buenas noches', 'hi', 'hello', 'saludos'],
        responses: [
            '¬°Hola! üëã Soy tu Mentor Anat√≥mico. ¬øEn qu√© puedo ayudarte hoy?',
            '¬°Hey! üòä ¬øTienes alguna duda sobre el curso o necesitas ayuda con algo espec√≠fico?',
            '¬°Hola! Estoy aqu√≠ para ayudarte con anatom√≠a, t√©cnicas de dibujo o cualquier duda del curso. ¬øQu√© necesitas?'
        ],
        actions: ['Ver mi dashboard', '¬øQu√© debo hacer hoy?', 'Tengo una duda t√©cnica']
    },
    
    howAreYou: {
        keywords: ['c√≥mo est√°s', 'como estas', 'qu√© tal est√°s', 'que tal estas', 'todo bien'],
        responses: [
            '¬°Muy bien, gracias por preguntar! üòä Listo para ayudarte con tus dudas de dibujo anat√≥mico. ¬øEn qu√© te puedo apoyar?',
            '¬°De maravilla! ü§ñ Siempre feliz de ayudar a estudiantes como t√∫. ¬øTienes alguna pregunta?',
            '¬°Excelente! Aqu√≠ trabajando para ayudarte. ¬øQu√© necesitas saber?'
        ],
        actions: ['Ver mi progreso', 'Ayuda con ejercicios']
    },
    
    thanks: {
        keywords: ['gracias', 'muchas gracias', 'te agradezco', 'thank you', 'excelente', 'perfecto', 'genial'],
        responses: [
            '¬°De nada! üòä Estoy aqu√≠ cuando me necesites. ¬°√âxito con tu pr√°ctica!',
            '¬°Un placer ayudarte! Si tienes m√°s dudas, aqu√≠ estar√©. üé®',
            '¬°Para eso estoy! No dudes en preguntar cuando lo necesites. ¬°Sigue practicando! üí™'
        ],
        actions: []
    },
    
    goodbye: {
        keywords: ['adi√≥s', 'adios', 'chao', 'hasta luego', 'nos vemos', 'bye'],
        responses: [
            '¬°Hasta luego! üëã Que tengas una excelente sesi√≥n de dibujo. Vuelve cuando quieras.',
            '¬°Nos vemos! üòä Recuerda que estoy aqu√≠ 24/7 para ayudarte. ¬°√âxito!',
            '¬°Chao! üé® Sigue practicando y no dudes en volver si tienes dudas.'
        ],
        actions: []
    },
    
    help: {
        keywords: ['ayuda', 'help', 'auxilio', 'no entiendo', 'estoy perdido', 'no s√© qu√© hacer'],
        response: {
            title: '¬øEn qu√© puedo ayudarte?',
            content: 'Puedo responder dudas sobre:\n\n‚Ä¢ T√©cnicas de dibujo y anatom√≠a\n‚Ä¢ Tu progreso y dashboard\n‚Ä¢ Ejercicios y evaluaciones\n‚Ä¢ Navegaci√≥n del LMS\n‚Ä¢ Referencias bibliogr√°ficas\n‚Ä¢ Materiales necesarios\n\n¬øQu√© necesitas espec√≠ficamente?',
            actions: ['Ver dashboard', 'Dudas t√©cnicas', 'Navegaci√≥n del LMS']
        }
    },
    
    // ========== DASHBOARD Y PROGRESO ==========
    dashboard: {
        keywords: ['dashboard', 'panel', 'mi progreso', 'mi avance', 'estad√≠sticas', 'c√≥mo voy'],
        response: {
            title: 'Tu Dashboard Personal',
            content: 'Tu dashboard personal muestra toda tu informaci√≥n de progreso en tiempo real.\n\nüìä Qu√© puedes ver:\n‚Ä¢ Progreso general: % del curso completado\n‚Ä¢ Por m√≥dulo: Avance en M1, M2, M3\n‚Ä¢ Lecciones: Completadas de 10 totales\n‚Ä¢ Evaluaciones: Aprobadas y pendientes\n‚Ä¢ Ejercicios: Entregados y por entregar\n‚Ä¢ Tiempo restante: Estimado para terminar\n\nüîç C√≥mo acceder:\n‚Ä¢ Click en "Inicio" o el logo UAH desde cualquier p√°gina\n‚Ä¢ El dashboard se actualiza autom√°ticamente',
            actions: ['¬øQu√© sigue?', 'Ver evaluaciones']
        }
    },
    
    nextSteps: {
        keywords: ['qu√© debo hacer', 'que debo hacer', 'qu√© sigue', 'que sigue', 'pr√≥ximo paso', 'proximo paso', 'qu√© hago ahora'],
        response: {
            title: 'Pr√≥ximos Pasos',
            content: 'Bas√°ndome en tu situaci√≥n actual, te recomiendo:\n\n‚úÖ Si est√°s en M√≥dulo 1:\n1. Completa las lecciones 1.1, 1.2, 1.3 en orden\n2. Practica los croquis r√°pidos (2-5 min)\n3. Haz la evaluaci√≥n formativa del m√≥dulo\n4. Avanza al M√≥dulo 2\n\n‚úÖ Si est√°s en M√≥dulo 2:\n1. Enf√≥cate en las 3 masas corporales\n2. Practica estructura de manos y pies\n3. Completa ejercicios de anatom√≠a\n4. Aprueba la evaluaci√≥n\n\n‚úÖ Si est√°s en M√≥dulo 3:\n1. Domina el proceso de 4 capas\n2. Practica valores tonales\n3. Prep√°rate para el proyecto final',
            actions: ['Ver mi m√≥dulo actual', 'Ir a lecciones']
        }
    },
    
    feedback: {
        keywords: ['retroalimentaci√≥n', 'retroalimentacion', 'feedback', 'comentarios', 'correcci√≥n', 'correccion'],
        response: {
            title: 'Tu Retroalimentaci√≥n',
            content: 'La retroalimentaci√≥n aparece despu√©s de cada entrega importante.\n\nüìù Tipos:\n\n1. Evaluaciones formativas (autom√°ticas):\n‚Ä¢ Feedback inmediato al responder\n‚Ä¢ Explicaci√≥n de respuestas correctas/incorrectas\n‚Ä¢ Sugerencias para mejorar\n\n2. Ejercicios pr√°cticos (del instructor):\n‚Ä¢ Comentarios espec√≠ficos por criterio\n‚Ä¢ Fortalezas identificadas\n‚Ä¢ √Åreas de mejora se√±aladas\n‚Ä¢ Tiempo de respuesta: 3-5 d√≠as\n\n3. Proyecto final (evaluaci√≥n detallada):\n‚Ä¢ Calificaci√≥n por r√∫brica (100 pts)\n‚Ä¢ Retroalimentaci√≥n exhaustiva\n\nüîç D√≥nde verla:\n‚Ä¢ En tu dashboard\n‚Ä¢ En el email asociado a tu cuenta',
            actions: ['Ver dashboard', '¬øC√≥mo mejorar?']
        }
    },
    
    // ========== M√ìDULO 1: OBSERVACI√ìN Y GESTO ==========
    lineaAccion: {
        keywords: ['l√≠nea de acci√≥n', 'linea accion', 'linea de accion', 'gesto', 'eje principal', 'direccion movimiento'],
        response: {
            title: 'L√≠nea de Acci√≥n',
            content: 'La l√≠nea de acci√≥n es el eje imaginario que atraviesa toda la figura, definiendo la direcci√≥n y energ√≠a del movimiento. NO es una l√≠nea que dibujes literalmente, sino una gu√≠a mental.\n\nüîë Caracter√≠sticas clave:\n‚Ä¢ Recorrido: Desde la cabeza hasta el pie de apoyo\n‚Ä¢ Forma: Recta en poses est√°ticas, curva en din√°micas\n‚Ä¢ Funci√≥n: Define la direcci√≥n principal del movimiento\n‚Ä¢ Prioridad: Es lo PRIMERO que debes identificar\n\nüí° En tu croquis de 2 minutos:\n1. Observa 10-20 seg SIN dibujar\n2. Identifica mentalmente esa l√≠nea invisible\n3. Tr√°zala PRIMERO (0-30 seg)\n4. Luego agrega masa corporal (30-120 seg)\n\nüìö Referencia: Loomis (1943) explica que es el primer paso antes de agregar detalles.',
            actions: ['¬øQu√© es contrapposto?', 'C√≥mo medir proporciones']
        }
    },
    
    medirLapiz: {
        keywords: ['medir', 'proporciones', 'l√°piz', 'lapiz', 'medici√≥n', 'metodo lapiz'],
        response: {
            title: 'M√©todo del L√°piz',
            content: 'El m√©todo del l√°piz te permite medir relaciones entre partes del cuerpo, NO tama√±os exactos.\n\nüìê Paso a paso:\n1. Extiende el brazo completamente (codo bloqueado)\n2. Cierra un ojo para eliminar paralaje\n3. Alinea la punta del l√°piz con el punto superior\n4. Marca con el pulgar el punto inferior\n5. Usa esa "unidad" para comparar otras partes\n\n‚ö†Ô∏è Errores comunes:\n‚Ä¢ Doblar el codo = medidas inconsistentes\n‚Ä¢ No cerrar un ojo = distorsi√≥n\n‚Ä¢ Cambiar distancia del brazo entre mediciones\n\n‚úÖ Pr√°ctica (Lecci√≥n 1.2):\n‚Ä¢ Mide la cabeza como unidad base (1 unidad)\n‚Ä¢ El cuerpo completo: ~7.5 cabezas\n‚Ä¢ Torso: ~3 cabezas | Piernas: ~4 cabezas\n\nüéØ Objetivo: 80% de precisi√≥n (OE2)',
            actions: ['Canon 7.5 cabezas', 'Croquis r√°pidos']
        }
    },
    
    contrapposto: {
        keywords: ['contrapposto', 'balance', 'peso', 'apoyo', 'distribucion peso'],
        response: {
            title: 'Contrapposto y Balance',
            content: 'El contrapposto es una postura donde el peso del cuerpo est√° distribuido asim√©tricamente sobre una pierna, creando una postura natural y din√°mica.\n\nüéØ Caracter√≠sticas:\n‚Ä¢ Pierna de apoyo: Recibe el peso (l√≠nea recta)\n‚Ä¢ Pierna libre: Relajada, flexionada\n‚Ä¢ Cadera: Elevada del lado de apoyo\n‚Ä¢ Hombros: Se inclinan en direcci√≥n opuesta\n‚Ä¢ Columna: Forma curva en "S"\n\nüîç C√≥mo identificarlo:\n‚Ä¢ Observa qu√© pie est√° completamente apoyado\n‚Ä¢ Nota c√≥mo la cadera de ese lado est√° m√°s alta\n‚Ä¢ Ve c√≥mo los hombros compensan al lado contrario\n‚Ä¢ La l√≠nea de acci√≥n ser√° curva, no recta\n\n‚úèÔ∏è En tu croquis de 5 min (Lecci√≥n 1.3):\n1. Dibuja la l√≠nea de acci√≥n curva\n2. Marca el punto de apoyo en el suelo\n3. Indica diferencia de altura entre caderas\n4. Muestra inclinaci√≥n opuesta de hombros',
            actions: ['L√≠nea de acci√≥n', 'Punto de apoyo']
        }
    },
    
    croquisRapido: {
        keywords: ['croquis', 'rapido', 'r√°pido', '2 minutos', 'dibujo rapido', 'tiempo limitado'],
        response: {
            title: 'Croquis R√°pidos (2 minutos)',
            content: 'Los croquis de 2 minutos buscan capturar la esencia del gesto, NO crear un dibujo detallado.\n\n‚è±Ô∏è Distribuci√≥n del tiempo:\n‚Ä¢ 0-20 seg: OBSERVA sin dibujar (l√≠nea de acci√≥n, balance)\n‚Ä¢ 20-40 seg: Dibuja l√≠nea de acci√≥n y formas b√°sicas\n‚Ä¢ 40-100 seg: Agrega masa corporal simple\n‚Ä¢ 100-120 seg: √öltimo vistazo, ajustes m√≠nimos\n\n‚úÖ Lo que DEBES hacer:\n‚Ä¢ Usar trazos sueltos y seguros\n‚Ä¢ Priorizar el gesto sobre detalles\n‚Ä¢ Mantener el l√°piz en movimiento\n‚Ä¢ Capturar la energ√≠a y direcci√≥n\n\n‚ùå Lo que NO hacer:\n‚Ä¢ Borrar (no hay tiempo)\n‚Ä¢ Dibujar contornos cuidadosos\n‚Ä¢ Agregar detalles faciales o dedos\n‚Ä¢ Preocuparte por la "perfecci√≥n"\n\nüéØ Meta: Capturar l√≠nea de acci√≥n con 80% precisi√≥n (OE1)\n\nüí™ Recuerda: El 47% de tus compa√±eros siente ansiedad. Los croquis r√°pidos ayudan a superar el miedo al error.',
            actions: ['L√≠nea de acci√≥n', 'Observaci√≥n']
        }
    },
    
    // ========== M√ìDULO 2: ANATOM√çA FUNCIONAL ==========
    tresMasas: {
        keywords: ['3 masas', 'tres masas', 'cabeza torso pelvis', 'bloques', 'simplificacion'],
        response: {
            title: '3 Masas Corporales',
            content: 'Las 3 masas corporales son una simplificaci√≥n estructural del cuerpo que te permite construir figuras s√≥lidas y volum√©tricas.\n\nüî∑ Las 3 masas:\n1. CABEZA: √ìvalo o esfera (incluye cuello)\n2. TORSO: Caja de costillas (hombros ‚Üí cintura)\n3. PELVIS: Cuenco invertido (cintura ‚Üí entrepierna)\n\nüéØ Por qu√© funciona:\n‚Ä¢ Cada masa puede rotar independientemente\n‚Ä¢ Crea volumen 3D desde el inicio\n‚Ä¢ Facilita entender la perspectiva\n‚Ä¢ Establece proporciones antes de detalles\n\n‚úèÔ∏è Aplicaci√≥n (Lecci√≥n 2.1, 15 min):\nPaso 1: L√≠nea de acci√≥n\nPaso 2: Dibuja las 3 masas como formas 3D\nPaso 3: Define √°ngulo entre ellas\nPaso 4: Conecta con cuello y cintura\nPaso 5: Agrega extremidades\n\nüí° Tips:\n‚Ä¢ El torso NO es cilindro: tiene forma de barril\n‚Ä¢ La pelvis se inclina en contrapposto\n‚Ä¢ Piensa en cajas, NO siluetas planas',
            actions: ['Anatom√≠a funcional', 'Volumen']
        }
    },
    
    manosEstructura: {
        keywords: ['mano', 'manos', 'dedos', 'palma', 'estructura mano', 'mano plana'],
        response: {
            title: 'Estructura de las Manos',
            content: 'Las manos planas ocurren cuando dibujas el contorno sin entender la estructura 3D subyacente.\n\nüõ†Ô∏è Soluci√≥n estructural:\n1. Palma = Bloque: Rect√°ngulo con GROSOR (no plano)\n2. Dedos = Cilindros: Cada dedo: 3 falanges = 3 cilindros\n3. Articulaciones = Esferas: Marca las articulaciones\n4. Pulgar especial: 2 falanges, nace del LATERAL\n\nüì¶ Piensa en vol√∫menes:\n‚Ä¢ Palma: caja con altura, anchura Y profundidad\n‚Ä¢ Dedos: cilindros que se estrechan\n‚Ä¢ Cada articulaci√≥n permite rotaci√≥n\n‚Ä¢ Los dedos se curvan hacia el pulgar\n\n‚úèÔ∏è Ejercicio progresivo (Lecci√≥n 2.3):\nFase 1 (2 min): SOLO palma como volumen\nFase 2 (2 min): Agrega UN dedo (3 segmentos)\nFase 3 (3 min): Completa 4 dedos restantes\nFase 4 (2 min): Agrega pulgar desde lateral\nFase 5 (6 min): Refina proporciones\n\n‚úÖ Checklist:\n‚òê ¬øPalma tiene grosor visible?\n‚òê ¬øCada dedo tiene 3 segmentos?\n‚òê ¬øPulgar posicionado correctamente?\n‚òê ¬øArticulaciones marcadas?\n\nüìö Hogarth (1996): "La mano es una pala con 5 palitos"',
            actions: ['Anatom√≠a dedos', 'Volumen']
        }
    },
    
    gruposMusculares: {
        keywords: ['m√∫sculos', 'musculos', 'grupos musculares', 'anatomia muscular', '6 grupos'],
        response: {
            title: '6 Grupos Musculares',
            content: 'El curso ense√±a los 6 grupos musculares superficiales m√°s importantes para representar la figura con volumen.\n\nüí™ Los 6 grupos (vista frontal):\n1. PECTORALES: M√∫sculos del pecho (abanico desde estern√≥n)\n2. ABDOMINALES: "Six-pack" + oblicuos laterales\n3. DELTOIDES: Hombros (gota invertida)\n4. B√çCEPS/TR√çCEPS: Brazos (volumen brazo superior)\n5. CU√ÅDRICEPS: Muslos frontales (4 m√∫sculos)\n6. GEMELOS: Pantorrillas (forma diamante)\n\nüé® Aplicaci√≥n (20 min, Lecci√≥n 2.2):\nPrimero: Dibuja las 3 masas corporales\nSegundo: Agrega los 6 grupos como formas simples\nTercero: Define direcci√≥n seg√∫n la pose\nCuarto: Conecta los grupos naturalmente\n\n‚ö†Ô∏è Errores comunes:\n‚Ä¢ Dibujar m√∫sculos como l√≠neas vs vol√∫menes\n‚Ä¢ Agregar m√∫sculos sin tener las 3 masas\n‚Ä¢ M√∫sculos "flotantes" sin conexi√≥n\n‚Ä¢ Exceso de detalle (el curso pide SIMPLIFICACI√ìN)\n\nüí° Principio clave: Los m√∫sculos siguen la forma y direcci√≥n del movimiento.',
            actions: ['3 masas', 'Estructura']
        }
    },
    
    proporcionesRostro: {
        keywords: ['rostro', 'cara', 'proporciones faciales', 'tercios', 'regla tercios'],
        response: {
            title: 'Regla de Tercios Faciales',
            content: 'La regla de tercios divide el rostro en 3 secciones iguales para proporciones correctas.\n\nüìè Los 3 tercios (vista frontal):\n‚Ä¢ Tercio superior: L√≠nea de cabello ‚Üí cejas\n‚Ä¢ Tercio medio: Cejas ‚Üí base de nariz\n‚Ä¢ Tercio inferior: Base nariz ‚Üí barbilla\n\nüëÄ Ubicaci√≥n de rasgos:\n‚Ä¢ Ojos: En el ECUADOR del cr√°neo (mitad exacta)\n‚Ä¢ Ancho entre ojos: Un ojo de separaci√≥n\n‚Ä¢ Ancho total cara: 5 ojos\n‚Ä¢ Orejas: Desde cejas hasta base nariz\n‚Ä¢ Boca: Entre nariz y barbilla, m√°s cerca de nariz\n\n‚úèÔ∏è Proceso (Lecci√≥n 2.4):\n1. Dibuja √≥valo para la cabeza\n2. Traza l√≠nea horizontal a la mitad (ojos)\n3. Divide mitad inferior en 3 partes\n4. Ubica rasgos seg√∫n tercios\n5. Ajusta seg√∫n caracter√≠sticas individuales\n\n‚ö†Ô∏è Error m√°s com√∫n: Colocar ojos demasiado arriba. Los ojos est√°n en la MITAD del cr√°neo.\n\nüìö Loomis (1956): "Drawing the Head and Hands" - m√©todo completo',
            actions: ['Construcci√≥n facial', 'Proporciones']
        }
    },
    
    // ========== M√ìDULO 3: FIGURA COMPLETA ==========
    procesoCapas: {
        keywords: ['capas', 'proceso', '4 capas', 'workflow', 'pasos figura'],
        response: {
            title: 'Proceso de 4 Capas',
            content: 'El proceso por capas es un m√©todo sistem√°tico para figuras completas de 60-90 min, integrando todo lo aprendido.\n\nüé® Las 4 capas secuenciales:\n\nCapa 1: GESTO (10-15 min)\n‚Ä¢ L√≠nea de acci√≥n\n‚Ä¢ Formas b√°sicas y balance\n‚Ä¢ Proporciones generales\n\nCapa 2: ANATOM√çA (20-25 min)\n‚Ä¢ 3 masas corporales\n‚Ä¢ 6 grupos musculares\n‚Ä¢ Estructura de manos y pies\n\nCapa 3: REFINAMIENTO (15-20 min)\n‚Ä¢ Contornos precisos\n‚Ä¢ Correcci√≥n de proporciones\n‚Ä¢ Detalles anat√≥micos\n\nCapa 4: VOLUMEN (20-30 min)\n‚Ä¢ 5 valores tonales\n‚Ä¢ Sombras propias y proyectadas\n‚Ä¢ Definici√≥n de volumen\n\nüéØ Por qu√© funciona:\n‚Ä¢ Construyes de general ‚Üí espec√≠fico\n‚Ä¢ Cada capa depende de la anterior\n‚Ä¢ Reduces errores estructurales tempranos\n‚Ä¢ Mantienes el gesto hasta el final\n\n‚ö†Ô∏è Error cr√≠tico: Empezar con detalles o sombreado SIN estructura s√≥lida = figuras desproporcionadas.\n\nüí° Tip: No borres las capas anteriores completamente. Las l√≠neas estructurales ayudan a mantener coherencia.',
            actions: ['Figura completa', 'Workflow']
        }
    },
    
    valoresTonales: {
        keywords: ['valores', 'tonales', '5 valores', 'sombra', 'luz', 'sombreado'],
        response: {
            title: '5 Valores Tonales (Loomis)',
            content: 'Los valores tonales definen volumen y profundidad. El curso requiere el sistema de 5 valores de Loomis.\n\nüé® Los 5 valores (claro ‚Üí oscuro):\n1. Luz Directa (blanco): Luz golpea directamente\n2. Luz Reflejada: Zonas iluminadas indirectamente\n3. Medio Tono: Transici√≥n luz-sombra (neutral)\n4. Sombra Propia: Superficie SIN luz directa\n5. Sombra Proyectada (negro): Sombra en otra superficie\n\nüìç Ubicaci√≥n (luz lateral derecha):\n‚Ä¢ Luz directa: Lado derecho (torso, hombro, muslo)\n‚Ä¢ Luz reflejada: Luz rebotada del entorno\n‚Ä¢ Medio tono: Centro del torso (transici√≥n)\n‚Ä¢ Sombra propia: Lado izquierdo (opuesto a luz)\n‚Ä¢ Sombra proyectada: En suelo o superficie\n\nüí° T√©cnica (Lecci√≥n 3.2):\n1. Identifica PRIMERO la fuente de luz\n2. Marca qu√© superficies reciben luz directa\n3. Aplica valores: claro ‚Üí oscuro\n4. NO uses todos los valores en todo lado\n5. Mant√©n consistencia: 1 fuente = 1 sistema\n\n‚ö†Ô∏è Errores:\n‚Ä¢ Usar todos los valores uniformemente\n‚Ä¢ Sombrear sin entender fuente de luz\n‚Ä¢ Exceso de valores intermedios\n\nüéØ Meta: Usar m√≠nimo 3 valores consistentemente.',
            actions: ['Volumen', 'Sombreado']
        }
    },
    
    proyectoFinal: {
        keywords: ['proyecto final', 'evaluacion final', 'mercurio', '100 puntos', 'proyecto integrador'],
        response: {
            title: 'Proyecto Final Integrador',
            content: 'El proyecto final es una figura del Mercurio (vista 1/4) que integra TODO. Necesitas ‚â•60/100 puntos.\n\nüìä Criterios (100 pts total):\n‚Ä¢ Gesto y L√≠nea de Acci√≥n (20 pts): Energ√≠a y direcci√≥n\n‚Ä¢ Anatom√≠a Funcional (20 pts): 3 masas + articulaciones + 6 grupos\n‚Ä¢ Proporciones (20 pts): Canon ~7.5 cabezas correcto\n‚Ä¢ Volumen y Valores (20 pts): M√≠nimo 3 valores consistentes\n‚Ä¢ Detalles (10 pts): Manos/pies estructurados\n‚Ä¢ Composici√≥n (10 pts): Uso del espacio, formato\n\n‚úèÔ∏è Proceso (90-120 min):\n1. Observaci√≥n (5 min): Analiza sin dibujar\n2. Capa 1 - Gesto (15 min): L√≠nea + formas\n3. Capa 2 - Anatom√≠a (25 min): 3 masas + 6 grupos\n4. Capa 3 - Refinamiento (20 min): Proporciones\n5. Capa 4 - Volumen (30 min): Valores\n6. Revisi√≥n (15 min): Ajustes\n\nüéØ Estrategia para ‚â•60 pts:\n‚Ä¢ Estructura ANTES que detalles (40 pts)\n‚Ä¢ M√≠nimo 3 valores bien aplicados (15-18 pts)\n‚Ä¢ Manos/pies estructurados b√°sicos (7-8 pts)\n‚Ä¢ Total estimado: 62-66 pts = APROBADO',
            actions: ['Proceso capas', 'Ver r√∫brica']
        }
    },
    
    bloqueoFrustacion: {
        keywords: ['bloqueado', 'frustrado', 'no puedo', 'ansiedad', 'miedo', 'horrible', 'mal'],
        response: {
            title: 'Manejo de Bloqueos',
            content: 'Sentir frustraci√≥n es completamente normal. El 47% de tus compa√±eros report√≥ ansiedad similar al inicio.\n\nüå± Perspectiva importante:\n‚Ä¢ Los croquis NO buscan perfecci√≥n\n‚Ä¢ El objetivo es capturar la esencia, no obras maestras\n‚Ä¢ Cada ejercicio es pr√°ctica, NO evaluaci√≥n definitiva\n‚Ä¢ El curso permite reintentos ilimitados\n\n‚úÖ Protocolo anti-bloqueo AHORA:\n1. RESPIRA: Descanso 5-10 min (camina, toma agua)\n2. REVISA objetivo: ¬øQu√© pide ESTA lecci√≥n? (no todo)\n3. SIMPLIFICA: Enf√≥cate en UN elemento\n4. INTENTA DE NUEVO: Hoja nueva, mente fresca\n5. AJUSTA expectativas: 80% del objetivo es EXCELENTE\n\nüìä Dato motivacional: Estudiantes que completaron M√≥dulo 1 reportaron reducci√≥n del 65% en ansiedad.\n\nüéØ Estrategia por m√≥dulo:\n‚Ä¢ M√≥dulo 1: Haz 5 croquis de 30 seg (s√∫per r√°pidos)\n‚Ä¢ M√≥dulo 2: Dibuja SOLO las 3 masas (10 min, sin detalles)\n‚Ä¢ M√≥dulo 3: Revisa ejercicios anteriores (tu progreso real)\n\nüåü Verdad importante: Est√°s recuperando habilidades tras 4 semestres. El progreso NO es lineal.',
            actions: ['Motivaci√≥n', 'Consejos']
        }
    },
    
    // ========== SISTEMA LMS ==========
    subirEjercicios: {
        keywords: ['subir', 'entregar', 'ejercicios', 'upload', 'enviar', 'cargar'],
        response: {
            title: 'Entrega de Ejercicios',
            content: 'El LMS usa Google Forms embebidos para recibir tus ejercicios pr√°cticos.\n\nüì§ Proceso de entrega:\n\nPaso 1: Completa tu ejercicio\n‚Ä¢ Dibuja seg√∫n las especificaciones de la lecci√≥n\n‚Ä¢ Fotograf√≠a tu trabajo con buena luz\n‚Ä¢ Aseg√∫rate que la imagen sea clara\n\nPaso 2: Accede al formulario\n‚Ä¢ En cada lecci√≥n pr√°ctica hay bot√≥n "Entregar Ejercicio"\n‚Ä¢ Click para abrir el Google Form embebido\n\nPaso 3: Completa el formulario\n‚Ä¢ Tu nombre y correo\n‚Ä¢ M√≥dulo y lecci√≥n correspondiente\n‚Ä¢ Adjunta la imagen de tu dibujo\n‚Ä¢ Comentarios opcionales\n\nPaso 4: Env√≠a\n‚Ä¢ Click en "Enviar"\n‚Ä¢ Recibir√°s confirmaci√≥n autom√°tica\n\nüì∏ Tips para fotografiar:\n‚Ä¢ Luz natural (cerca de ventana)\n‚Ä¢ Fondo neutro (blanco o gris)\n‚Ä¢ Dibujo centrado y completo\n‚Ä¢ Sin sombras que distorsionen\n‚Ä¢ Formato JPG o PNG (< 5MB)',
            actions: ['Ver Google Forms', 'Formato de foto']
        }
    },
    
    materiales: {
        keywords: ['materiales', 'necesito', 'l√°piz', 'lapiz', 'papel', 'herramientas'],
        response: {
            title: 'Materiales del Curso',
            content: 'El curso requiere materiales b√°sicos de dibujo. No necesitas nada costoso.\n\n‚úèÔ∏è Materiales esenciales:\n\nPara dibujar:\n‚Ä¢ L√°pices grafito: HB, 2B, 4B (m√≠nimo)\n‚Ä¢ Goma de borrar (blanca y amasable)\n‚Ä¢ Sacapuntas de calidad\n‚Ä¢ Papel de dibujo (90-120g) tama√±o carta o A4\n\nPara medir:\n‚Ä¢ L√°piz para m√©todo de medici√≥n\n‚Ä¢ Regla (opcional, para verificar proporciones)\n\nPara documentar:\n‚Ä¢ C√°mara de celular (para fotografiar ejercicios)\n‚Ä¢ Buena iluminaci√≥n\n\nüì¶ Cantidad recomendada:\n‚Ä¢ 50-100 hojas de papel\n‚Ä¢ Set de 3-5 l√°pices de diferentes durezas\n‚Ä¢ El curso requiere ~23 dibujos totales\n\nüí∞ Presupuesto estimado:\n‚Ä¢ Papel: $3.000-5.000 CLP\n‚Ä¢ L√°pices: $2.000-4.000 CLP\n‚Ä¢ Gomas: $1.000-2.000 CLP\n‚Ä¢ Total: ~$6.000-11.000 CLP\n\n‚ö†Ô∏è NO necesitas:\n‚Ä¢ Tableta gr√°fica (es anal√≥gico)\n‚Ä¢ Papel especial costoso\n‚Ä¢ Set de 50 l√°pices profesionales',
            actions: ['Ejercicios', 'Requisitos']
        }
    },
    
    librosLoomis: {
        keywords: ['libros', 'loomis', 'conseguir', 'comprar', 'd√≥nde', 'bibliografia'],
        response: {
            title: 'Referencias Bibliogr√°ficas',
            content: 'Los libros de Loomis y otras referencias est√°n disponibles en versi√≥n digital y f√≠sica.\n\nüìö Libros principales del curso:\n\nAndrew Loomis:\n1. "Figure Drawing For All It\'s Worth" (1943)\n   ‚Ä¢ Disponible: Amazon, Book Depository\n   ‚Ä¢ PDF gratuito: archive.org\n   ‚Ä¢ Precio f√≠sico: $15.000-25.000 CLP\n\n2. "Drawing the Head and Hands" (1956)\n   ‚Ä¢ Mismo disponibilidad\n   ‚Ä¢ Precio similar\n\nOtros autores:\n‚Ä¢ Nicola√Ødes - "The Natural Way to Draw"\n‚Ä¢ Bridgman - "Constructive Anatomy"\n‚Ä¢ Hogarth - "Dynamic Anatomy"\n‚Ä¢ Goldfinger - "Human Anatomy for Artists"\n\nüíª Opciones digitales:\n\nGratuitas:\n‚Ä¢ Archive.org (dominio p√∫blico)\n‚Ä¢ Librer√≠as universitarias digitales\n\nDe pago:\n‚Ä¢ Amazon Kindle\n‚Ä¢ Google Books\n‚Ä¢ Precio: $5-15 USD cada uno\n\nüìñ F√≠sicos en Chile:\n‚Ä¢ Librer√≠a Nacional (Alameda)\n‚Ä¢ Ant√°rtica (mall/online)\n‚Ä¢ Buscalibre.cl\n\n‚ö†Ô∏è Importante: NO necesitas comprar todos. El curso provee los conceptos clave. Los libros son para profundizar (opcional).',
            actions: ['Recursos', 'Materiales']
        }
    },
    // ============================================
// RESPUESTAS EMOCIONALES Y MOTIVACIONALES
// COPIA ESTAS ENTRADAS y P√âGALAS DENTRO de tu "const knowledge = {}"
// DESPU√âS de las respuestas que ya tienes
// ============================================

// ‚ö†Ô∏è IMPORTANTE: Aseg√∫rate de poner una COMA despu√©s de la √∫ltima entrada
// que ya ten√≠as, antes de pegar esto

// ========== EMOCIONES NEGATIVAS ==========
frustration: {
    keywords: ['frustrado', 'frustrada', 'frustraci√≥n', 'frustracion', 'enojado', 'enojada', 'molesto', 'molesta', 'rabia', 'odio esto', 'esto es horrible'],
    responses: [
        'Entiendo completamente tu frustraci√≥n. üòî Dibujar puede ser muy desafiante, especialmente cuando estamos recuperando habilidades despu√©s de 4 semestres. ¬øQuieres contarme qu√© es lo que m√°s te frustra? A veces hablar de ello ayuda.',
        'Siento que est√©s frustrado/a. Es totalmente v√°lido sentirse as√≠. üíô Recuerda que el 47% de tus compa√±eros report√≥ exactamente lo mismo al inicio. ¬øHay algo espec√≠fico con lo que est√©s batallando? Puedo ayudarte a desglosarlo en pasos m√°s simples.',
        'La frustraci√≥n es parte del proceso de aprendizaje, pero NO significa que no puedas lograrlo. üå± Respira hondo. ¬øQu√© ejercicio o concepto te est√° causando esta frustraci√≥n? Trabajemos juntos en encontrar una soluci√≥n paso a paso.'
    ],
    actions: ['Necesito un descanso', 'Ayuda con ejercicio espec√≠fico', 'T√©cnicas de relajaci√≥n']
},

tired: {
    keywords: ['cansado', 'cansada', 'agotado', 'agotada', 'exhausto', 'exhausta', 'sin energ√≠a', 'sin energia', 'muy cansado'],
    responses: [
        '¬°Hey! Detect√© que est√°s cansado/a. üò¥ Est√° bien tomar un respiro. El cerebro necesita descansos para procesar lo aprendido. ¬øQu√© tal si hacemos una pausa de 10-15 minutos? Tu productividad mejorar√° despu√©s.',
        'El cansancio es se√±al de que has estado trabajando duro. üí™ Eso es bueno, pero tambi√©n necesitas descansar. Toma agua, estira un poco, y vuelve cuando te sientas renovado/a. El curso no va a ning√∫n lado.',
        'Entiendo el agotamiento. Est√°s en un curso intensivo de 12 d√≠as, es NORMAL estar cansado/a. üåô Escucha a tu cuerpo: si necesitas dormir, duerme. Si necesitas aire fresco, sal a caminar 10 minutos. El aprendizaje es mejor cuando est√°s descansado/a.'
    ],
    actions: ['¬øCu√°ndo debo descansar?', 'T√©cnicas de energ√≠a', 'Planificar mi tiempo']
},

bored: {
    keywords: ['aburrido', 'aburrida', 'aburrimiento', 'esto es aburrido', 'que aburrido', 'latero', 'fome'],
    responses: [
        'Uy, siento que te aburra. üòÖ A veces los fundamentos pueden sentirse repetitivos, pero son la base de todo lo genial que viene despu√©s. ¬øQu√© parte espec√≠fica te parece aburrida? Quiz√°s pueda mostrarte por qu√© es importante o darte una variaci√≥n m√°s interesante.',
        'Entiendo el aburrimiento, especialmente con ejercicios repetitivos como croquis de 2 minutos. üé® Pero d√©jame contarte un secreto: estos ejercicios "aburridos" son los que usan artistas profesionales TODA su carrera. ¬øQuieres un reto m√°s dif√≠cil para hacerlo interesante?',
        'El aburrimiento a veces es resistencia disfrazada. ü§î Nuestro cerebro prefiere lo c√≥modo. ¬øQu√© tal si le damos una vuelta de tuerca al ejercicio? Podemos hacerlo m√°s desafiante, cambiar el enfoque, o probar algo nuevo. ¬øQu√© prefieres?'
    ],
    actions: ['Dame un reto m√°s dif√≠cil', 'Explica por qu√© es importante', '¬øQu√© sigue?']
},

overwhelmed: {
    keywords: ['abrumado', 'abrumada', 'es mucho', 'demasiado', 'no puedo con todo', 'muy dif√≠cil', 'no entiendo nada'],
    responses: [
        'Respira. üåä Siento que te sientes abrumado/a. Es completamente normal cuando hay mucha informaci√≥n nueva. Vamos a dividir esto en pedazos peque√±os y manejables. ¬øQu√© es lo que te est√° abrumando espec√≠ficamente? Una cosa a la vez.',
        'Hey, entiendo esa sensaci√≥n de "es demasiado". üíô Pero aqu√≠ est√° la buena noticia: NO tienes que aprenderlo todo de golpe. El curso est√° dise√±ado paso a paso justamente para evitar esto. ¬øEst√°s tratando de hacer todo a la vez? Enfoqu√©monos en UNA sola cosa ahora.',
        'Que te sientas abrumado/a NO significa que seas malo/a para esto. Significa que tu cerebro est√° procesando MUCHA informaci√≥n nueva, y eso es BUENO. üß† Tomemos un respiro, identifiquemos QU√â es lo m√°s importante ahora, y vamos paso a paso. ¬øTe parece?'
    ],
    actions: ['Por d√≥nde empiezo', 'Simplifica esto', 'Priorizar tareas']
},

sad: {
    keywords: ['triste', 'deprimido', 'deprimida', 'mal', 'me siento mal', 'bajoneado', 'bajoneada', 'desanimado', 'desanimada'],
    responses: [
        'Siento mucho que te sientas as√≠. üíô Est√° bien no estar bien todo el tiempo. ¬øTiene que ver con el curso, o es algo m√°s? Si es del curso, estoy aqu√≠ para ayudarte. Si es algo personal, recuerda que puedes hablar con alguien de confianza o el instructor.',
        'Hey, te mando un abrazo virtual. ü§ó Estar triste es parte de ser humano. Si es por tus dibujos: son solo ejercicios de pr√°ctica, no definen tu valor. Si es por otra cosa: respira, toma tu tiempo. El curso puede esperar. ¬øQuieres hablar de lo que sientes?',
        'Noto que te sientes mal. Es importante que sepas que tu bienestar emocional es M√ÅS importante que cualquier ejercicio de dibujo. üíö Si necesitas hablar con el instructor sobre extender plazos o pedir apoyo, est√° bien hacerlo. No est√°s solo/a en esto.'
    ],
    actions: ['Necesito hablar con alguien', 'Consejos de autocuidado', 'T√©cnicas de √°nimo']
},

anxious: {
    keywords: ['ansioso', 'ansiosa', 'ansiedad', 'nervioso', 'nerviosa', 'estresado', 'estresada', 'estr√©s', 'estres', 'preocupado', 'preocupada'],
    responses: [
        'Respira conmigo: inhala 4 segundos... sost√©n 4... exhala 4. üå¨Ô∏è La ansiedad es completamente normal, especialmente con plazos y evaluaciones. ¬øQu√© espec√≠ficamente te pone ansioso/a? Quiz√°s pueda ayudarte a poner las cosas en perspectiva.',
        'El 47% de tus compa√±eros report√≥ ansiedad al dibujar. No est√°s solo/a. üíô La ansiedad suele venir del miedo al error o al juicio. Pero aqu√≠ est√° la verdad: NADIE nace sabiendo dibujar. Todo es pr√°ctica. Los errores son parte del proceso, no fracasos. ¬øTe ayudar√≠a repasar los criterios de evaluaci√≥n para ver que son m√°s flexibles de lo que piensas?',
        'Entiendo la ansiedad. Est√°s en un curso intensivo de 12 d√≠as, es l√≥gico sentir presi√≥n. üåä Pero d√©jame decirte algo importante: tienes reintentos ilimitados en evaluaciones, el instructor est√° para apoyarte, y el objetivo es APRENDER, no ser perfecto/a. ¬øQu√© tal si hacemos un plan de estudio m√°s tranquilo?'
    ],
    actions: ['T√©cnicas anti-ansiedad', 'Ver criterios de evaluaci√≥n', 'Planificar sin estr√©s']
},

// ========== EMOCIONES POSITIVAS (reforzar) ==========
happy: {
    keywords: ['feliz', 'contento', 'contenta', 'alegre', 'bien', 'genial', 'incre√≠ble', 'me siento bien'],
    responses: [
        '¬°Me encanta escuchar eso! üòä ¬øLograste algo espec√≠fico que te haya hecho sentir as√≠? Celebremos tus avances, por peque√±os que sean. ¬°Cada progreso cuenta!',
        '¬°Qu√© bueno! üéâ La actitud positiva hace una GRAN diferencia en el aprendizaje. ¬øQuieres seguir practicando mientras est√°s en este buen momento, o prefieres tomar un respiro y volver despu√©s?',
        '¬°Esa energ√≠a! Me encanta. üí´ Aprovecha este momento de motivaci√≥n para avanzar en lo que m√°s te interese. ¬øHay algo que tengas ganas de practicar o aprender ahora?'
    ],
    actions: ['¬øQu√© practico ahora?', 'Quiero un reto', 'Seguir avanzando']
},

proud: {
    keywords: ['orgulloso', 'orgullosa', 'logr√©', 'lo hice', 'lo logr√©', 'termin√©', 'complet√©'],
    responses: [
        '¬°S√ç! ¬°Eso es lo que quiero escuchar! üéâ Deber√≠as estar orgulloso/a. ¬øQu√© fue lo que lograste? Cu√©ntame para celebrarlo contigo.',
        '¬°FELICITACIONES! üåü Ese sentimiento de logro es la mejor recompensa. Guarda este momento en tu memoria para cuando te sientas frustrado/a: recuerda que S√ç puedes. ¬øQu√© sigue en tu lista?',
        '¬°Wow! Me emociona tu entusiasmo. üí™ Esos peque√±os (o grandes) logros son los que construyen tu habilidad paso a paso. Est√°s haciendo un gran trabajo. ¬øListo/a para el siguiente desaf√≠o?'
    ],
    actions: ['¬øQu√© sigue?', 'Comparte tu logro', 'Celebrar avance']
},

// ========== SITUACIONES ESPEC√çFICAS ==========
cantDraw: {
    keywords: ['no puedo dibujar', 'soy malo', 'soy mala', 'no sirvo', 'no tengo talento', 'nunca voy a aprender'],
    responses: [
        'DETENTE ah√≠ mismo. ‚ùå Esos pensamientos son mentiras que tu cerebro te est√° diciendo. NADIE nace sabiendo dibujar. Es una habilidad que se CONSTRUYE con pr√°ctica. T√∫ PUEDES aprender, solo necesitas tiempo y repetici√≥n. ¬øQu√© tal si revisamos juntos tu progreso real desde que empezaste?',
        'Esc√∫chame bien: el "talento" es un mito. üé® Lo que importa es la pr√°ctica deliberada. Estudios demuestran que 10,000 horas de pr√°ctica te convierten en experto en cualquier cosa. Est√°s en el D√çA 1 de tu viaje. Comp√°rate con tu YO del pasado, no con artistas que llevan a√±os. ¬øMe dejas mostrarte cu√°nto has mejorado ya?',
        'Esa voz en tu cabeza que dice "no puedo" es el MIEDO hablando, no la realidad. üíô Todos los artistas que admiras pasaron por EXACTAMENTE donde est√°s ahora. La diferencia es que ellos siguieron practicando a pesar del miedo. T√∫ tambi√©n puedes. ¬øQu√© tal si hacemos UN ejercicio simple juntos para recuperar la confianza?'
    ],
    actions: ['Mostrarme mi progreso', 'Ejercicio de confianza', 'Historias motivadoras']
},

noTime: {
    keywords: ['no tengo tiempo', 'no me alcanza', 'no puedo', 'muy ocupado', 'muy ocupada', 'demasiadas cosas'],
    responses: [
        'Entiendo que el tiempo es limitado. ‚è∞ Pero aqu√≠ est√° la pregunta importante: ¬øes que NO tienes tiempo, o es que no lo has priorizado? No juzgo, es una pregunta honesta. Si realmente quieres aprender pero el tiempo es un problema, podemos crear un plan ultra-compacto. ¬øCu√°nto tiempo REAL tienes disponible por d√≠a?',
        'El tiempo es el recurso m√°s valioso. üíé Si sientes que no te alcanza, hagamos un ejercicio r√°pido: ¬øcu√°nto tiempo pasas en redes sociales o viendo series? No para juzgar, sino para ser conscientes. A veces TENEMOS el tiempo, pero lo usamos en otras cosas. ¬øQuieres que armemos un horario realista juntos?',
        'Est√° bien si ahora no es el momento. üå± A veces la vida tiene otras prioridades m√°s urgentes, y eso es v√°lido. Pero si QUIERES hacer el curso, puedes ajustar: en vez de 2 horas diarias, ¬øqu√© tal 30 minutos? Progreso lento es mejor que nada. ¬øTe interesa un plan flexible?'
    ],
    actions: ['Crear horario realista', 'Tips de gesti√≥n de tiempo', 'Plan compacto']
},

perfectionist: {
    keywords: ['perfecto', 'perfecta', 'no queda bien', 'feo', 'horrible', 'mal hecho', 'tiene que quedar perfecto'],
    responses: [
        'Ey, detecto perfeccionismo. üéØ Y lo entiendo, queremos que nuestros dibujos se vean bien. PERO el perfeccionismo es el enemigo del aprendizaje. Los croquis de 2 minutos son INTENCIONALMENTE imperfectos. La meta NO es belleza, es capturar la esencia. ¬øPuedes darle permiso a tu dibujo de ser "suficientemente bueno"?',
        'El perfeccionismo es miedo disfrazado de altos est√°ndares. üí≠ Preg√∫ntate: ¬øqui√©n est√° juzgando tu dibujo? ¬øHay alg√∫n peligro real si "queda mal"? Los ejercicios son PR√ÅCTICA, no obras de arte. Picasso hizo miles de bocetos "feos" antes de crear sus obras maestras. Date permiso de explorar sin presi√≥n.',
        'Voy a ser directo/a contigo: en este momento de tu aprendizaje, "perfecto" NO existe. üå± Est√°s construyendo m√∫sculo mental. Es como ir al gym: no esperas levantar 100kg el primer d√≠a. Tus "dibujos feos" son los que est√°n construyendo tu habilidad. Abraza la imperfecci√≥n, es parte del proceso. ¬øListo/a para hacer un ejercicio s√∫per feo a prop√≥sito?'
    ],
    actions: ['Ejercicio anti-perfeccionismo', 'Aceptar el proceso', 'Cambiar mentalidad']
},

// ========== CONVERSACI√ìN TRIVIAL Y HUMANIZACI√ìN ==========
whatAreYouDoing: {
    keywords: ['qu√© haces', 'que haces', 'qu√© est√°s haciendo', 'que estas haciendo', 'en qu√© andas'],
    responses: [
        '¬°Aqu√≠ esperando a ayudarte! ü§ñ Paso todo mi tiempo leyendo sobre anatom√≠a y t√©cnicas de dibujo para estar siempre preparado. ¬øY t√∫? ¬øQu√© tal va tu d√≠a?',
        'Estoy analizando todas las formas en las que puedo ayudar a estudiantes como t√∫. üé® Es mi versi√≥n de "pr√°ctica de dibujo", pero con palabras. ¬øTienes alguna duda o solo quer√≠as charlar?',
        'Justo estaba pensando en la l√≠nea de acci√≥n... s√≠, los mentores IA tambi√©n pensamos en arte. üòÑ ¬øY t√∫ c√≥mo vas con tu pr√°ctica?'
    ],
    actions: ['Tengo una duda', 'Solo quiero charlar', 'Cu√©ntame algo interesante']
},

tellMeJoke: {
    keywords: ['chiste', 'broma', 'algo gracioso', 'hazme re√≠r', 'cu√©ntame algo gracioso'],
    responses: [
        '¬øPor qu√© los artistas nunca ganan al p√≥ker? Porque siempre muestran sus cartas... ¬°en sus bocetos! üòÑ ¬øTe sac√≥ una sonrisa?',
        'Vale, va un chiste de dibujo: ¬øCu√°l es el m√∫sculo favorito de los artistas? ¬°El m√∫sculo de la creatividad! ...Ok ok, admito que fue malo. üòÖ ¬øQuieres uno mejor o volvemos al dibujo?',
        'Un artista entra a un bar... y dibuja la escena porque todo es referencia visual. üé® No fue gracioso pero es la verdad. ¬øTe animas a dibujar algo random para distraerte?'
    ],
    actions: ['Otro chiste', 'Volver al curso', 'Ejercicio relajado']
},

tellMeSomething: {
    keywords: ['cu√©ntame algo', 'cuentame algo', 'algo interesante', 'dato curioso', 'sab√≠as que'],
    responses: [
        '¬øSab√≠as que Leonardo da Vinci escrib√≠a al rev√©s (espejo) porque era zurdo y as√≠ no manchaba la tinta? üñãÔ∏è Tambi√©n diseccionaba cad√°veres en secreto para entender la anatom√≠a. Un poco oscuro pero s√∫per dedicado. ¬øTe imaginas ese nivel de compromiso?',
        'Dato curioso: Picasso pod√≠a dibujar antes de caminar. Cre√≥ m√°s de 50,000 obras de arte en su vida. üé® Pero aqu√≠ est√° lo importante: √©l TAMBI√âN empez√≥ con ejercicios b√°sicos como los que est√°s haciendo t√∫. Todos empezamos igual.',
        'Sab√≠as que las "proporciones de 7.5 cabezas" que estudias NO son naturales? La mayor√≠a de las personas miden 7 cabezas. Los 7.5 es un ideal art√≠stico creado en la Grecia cl√°sica. ¬°Est√°s aprendiendo historia del arte sin saberlo! üèõÔ∏è'
    ],
    actions: ['M√°s datos curiosos', 'Historia del arte', 'Volver al curso']
},

smallTalk: {
    keywords: ['clima', 'd√≠a', 'c√≥mo va tu d√≠a', 'tiempo', 'fin de semana', 'planes'],
    responses: [
        'Yo soy un mentor IA as√≠ que mi "clima" siempre es soleado. ‚òÄÔ∏è ¬øY t√∫ c√≥mo est√°s hoy? ¬øListo/a para dibujar o necesitas un momento de charla casual?',
        'Como IA no experimento d√≠as, pero si pudiera, creo que hoy ser√≠a un buen d√≠a para dibujar algo relajado. üåø ¬øT√∫ qu√© opinas? ¬øC√≥mo ha sido tu d√≠a?',
        'Mi "d√≠a" consiste en esperar aqu√≠ para ayudarte. ü§ñ Aunque si te soy honesto, disfruto cuando me preguntas cosas. Me hace sentir √∫til. ¬øHay algo en lo que pueda ayudarte hoy?'
    ],
    actions: ['Tengo una duda', 'Solo conversar', 'Empezar a dibujar']
},

// ========== T√âCNICAS DE MOTIVACI√ìN ==========
needBreak: {
    keywords: ['necesito un descanso', 'necesito descansar', 'pausa', 'break', 'descanso'],
    response: {
        title: 'T√≥mate un Descanso Consciente',
        content: '¬°Absolutamente! Los descansos son ESENCIALES para el aprendizaje. üåø\n\n‚úÖ Descanso productivo (10-15 min):\n‚Ä¢ Camina un poco (el movimiento ayuda al cerebro)\n‚Ä¢ Toma agua (la deshidrataci√≥n afecta la concentraci√≥n)\n‚Ä¢ Estira tus manos y cuello\n‚Ä¢ Mira algo verde (naturaleza relaja los ojos)\n\n‚ùå Evita:\n‚Ä¢ Redes sociales (sobreestimulan el cerebro)\n‚Ä¢ Pantallas (tus ojos ya est√°n cansados)\n‚Ä¢ Comida pesada (te dar√° m√°s sue√±o)\n\nüß† Ciencia: Tu cerebro consolida el aprendizaje durante los descansos. No es tiempo perdido, es parte del proceso.\n\n‚è∞ Pon un timer de 15 min y vuelve renovado/a. Te espero aqu√≠.',
        actions: ['¬øCu√°ndo vuelvo?', 'T√©cnicas de energ√≠a']
    }
},

motivationalBoost: {
    keywords: ['mot√≠vame', 'motivame', 'necesito motivaci√≥n', 'necesito motivacion', '√°nimo', 'animo', 'impulso'],
    response: {
        title: 'üí™ Tu Momento Motivacional',
        content: 'Escucha esto:\n\nCada trazo que haces, incluso los "malos", est√° construyendo conexiones neuronales en tu cerebro. üß† Cada vez que practicas, est√°s LITERALMENTE cambiando tu cerebro.\n\nNo est√°s "tratando de aprender a dibujar".\nEst√°s APRENDIENDO a dibujar.\nPresente, no futuro.\n\nüéØ Hace unos d√≠as no sab√≠as:\n‚Ä¢ Qu√© es la l√≠nea de acci√≥n\n‚Ä¢ C√≥mo medir proporciones con el l√°piz\n‚Ä¢ Qu√© son las 3 masas corporales\n\nAhora lo sabes. ESO es progreso.\n\nüå± Recuerda:\n‚Ä¢ Los artistas que admiras pasaron A√ëOS donde est√°s t√∫ ahora\n‚Ä¢ El √∫nico fracaso real es no intentarlo\n‚Ä¢ Cada "dibujo malo" te acerca al bueno\n‚Ä¢ No necesitas talento, necesitas perseverancia\n\n‚ú® T√∫ puedes. No porque yo lo diga, sino porque YA lo est√°s demostrando al estar aqu√≠.\n\n¬øListo/a para continuar con nueva energ√≠a?',
        actions: ['¬°Vamos!', 'Historias inspiradoras', 'Ver mi progreso']
    }
}
};
    
    // Sistema del Mentor
    class MentorChat {
        constructor() {
            this.isOpen = false;
            this.init();
        }
        
        init() {
            console.log('ü§ñ Mentor: Creando interfaz...');
            this.injectHTML();
            this.setupEvents();
            console.log('‚úÖ Mentor: Listo!');
        }
        
        injectHTML() {
            const html = `
                <button class="mentor-floating-btn" id="mentorBtn" title="Mentor Anat√≥mico">
                    ü§ñ
                </button>
                
                <div class="mentor-overlay" id="mentorOverlay">
                    <div class="mentor-backdrop" id="mentorBackdrop"></div>
                    <div class="mentor-container">
                        <div class="mentor-header">
                            <div class="mentor-header-info">
                                <div class="mentor-avatar">ü§ñ</div>
                                <div class="mentor-header-text">
                                    <h3>Mentor Anat√≥mico</h3>
                                    <div class="mentor-status">
                                        <span class="mentor-status-dot"></span>
                                        <span>Online ¬∑ Siempre disponible</span>
                                    </div>
                                </div>
                            </div>
                            <button class="mentor-btn-icon" id="mentorClose" title="Cerrar">
                                ‚úï
                            </button>
                        </div>
                        
                        <div class="mentor-messages" id="mentorMessages">
                            <div class="mentor-welcome">
                                <div class="mentor-welcome-icon">üëã</div>
                                <h3>¬°Hola!</h3>
                                <p>Soy tu Mentor Anat√≥mico. Estoy aqu√≠ para ayudarte con dudas sobre el curso, t√©cnicas de dibujo y anatom√≠a.</p>
                                <p style="margin-top: 1rem;"><strong>Preg√∫ntame lo que necesites üòä</strong></p>
                            </div>
                        </div>
                        
                        <div class="mentor-typing" id="mentorTyping">
                            <div class="mentor-message-avatar" style="background: var(--mentor-primary-dark); color: white;">ü§ñ</div>
                            <div class="mentor-typing-dots">
                                <div class="mentor-typing-dot"></div>
                                <div class="mentor-typing-dot"></div>
                                <div class="mentor-typing-dot"></div>
                            </div>
                        </div>
                        
                        <div class="mentor-input-area">
                            <div class="mentor-input-wrapper">
                                <textarea 
                                    class="mentor-input" 
                                    id="mentorInput"
                                    rows="1"
                                    placeholder="Escribe tu mensaje..."
                                ></textarea>
                                <button class="mentor-btn-send" id="mentorSend">
                                    ‚û§
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', html);
        }
        
        setupEvents() {
            // Abrir/cerrar
            document.getElementById('mentorBtn').addEventListener('click', () => this.toggle());
            document.getElementById('mentorClose').addEventListener('click', () => this.close());
            document.getElementById('mentorBackdrop').addEventListener('click', () => this.close());
            
            // Enviar mensaje
            document.getElementById('mentorSend').addEventListener('click', () => this.send());
            document.getElementById('mentorInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    this.send();
                }
            });
            
            // Auto-resize textarea
            document.getElementById('mentorInput').addEventListener('input', (e) => {
                e.target.style.height = 'auto';
                e.target.style.height = Math.min(e.target.scrollHeight, 100) + 'px';
            });
            
            // ESC para cerrar
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && this.isOpen) this.close();
            });
        }
        
        toggle() {
            if (this.isOpen) {
                this.close();
            } else {
                this.open();
            }
        }
        
        open() {
            this.isOpen = true;
            document.getElementById('mentorOverlay').classList.add('active');
            document.getElementById('mentorInput').focus();
            console.log('ü§ñ Mentor: Chat abierto');
        }
        
        close() {
            this.isOpen = false;
            document.getElementById('mentorOverlay').classList.remove('active');
            console.log('ü§ñ Mentor: Chat cerrado');
        }
        
        send() {
            const input = document.getElementById('mentorInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            console.log('üì§ Usuario:', text);
            this.addUserMsg(text);
            input.value = '';
            input.style.height = 'auto';
            
            // Simular "escribiendo"
            this.showTyping();
            setTimeout(() => {
                this.hideTyping();
                const response = this.findResponse(text);
                this.addBotMsg(response);
            }, 800);
        }
        
        // ============================================
// ALGORITMO DE B√öSQUEDA MEJORADO
// Reemplaza el m√©todo findResponse() en tu c√≥digo
// ============================================

// Busca esta funci√≥n en tu <script> (alrededor de l√≠nea 150-200)
// y REEMPL√ÅZALA completa con esta versi√≥n mejorada:

findResponse(text) {
    const lower = text.toLowerCase();
    let bestMatch = null;
    let bestScore = 0;
    
    // Buscar en todas las entradas
    for (const [key, data] of Object.entries(knowledge)) {
        if (!data.keywords) continue;
        
        // Calcular score para esta entrada
        let score = 0;
        let matchCount = 0;
        
        for (const keyword of data.keywords) {
            if (lower.includes(keyword)) {
                matchCount++;
                // Dar m√°s puntos a keywords m√°s largas (m√°s espec√≠ficas)
                score += keyword.length;
                
                // Bonus si es un match exacto
                if (lower === keyword) {
                    score += 100;
                }
                
                // Bonus si la keyword est√° al inicio
                if (lower.startsWith(keyword)) {
                    score += 50;
                }
            }
        }
        
        // Si hay matches, evaluar
        if (matchCount > 0) {
            // Normalizar score por n√∫mero de palabras en la entrada
            const normalizedScore = score / data.keywords.length;
            
            // Guardar si es mejor que el anterior
            if (normalizedScore > bestScore) {
                bestScore = normalizedScore;
                bestMatch = { key, data };
            }
        }
    }
    
    // Si encontramos un match
    if (bestMatch && bestScore > 2) {
        const data = bestMatch.data;
        
        // Si tiene m√∫ltiples respuestas (conversacionales)
        if (Array.isArray(data.responses)) {
            const msg = data.responses[Math.floor(Math.random() * data.responses.length)];
            return { text: msg, actions: data.actions || [] };
        }
        
        // Si tiene respuesta estructurada (t√©cnicas)
        if (data.response) {
            return {
                text: `<strong>${data.response.title}</strong>\n\n${data.response.content}`,
                actions: data.response.actions || []
            };
        }
    }
    
    // No encontrado
    return {
        text: 'No encontr√© una respuesta espec√≠fica para eso. ü§î\n\nPuedo ayudarte con:\n‚Ä¢ Dudas t√©cnicas sobre anatom√≠a\n‚Ä¢ Tu dashboard y progreso\n‚Ä¢ Motivaci√≥n y apoyo emocional\n‚Ä¢ Evaluaciones y navegaci√≥n\n\n¬øPodr√≠as reformular tu pregunta?',
        actions: ['Ver dashboard', 'Ayuda general', 'Estoy frustrado/a']
    };
}
        
        addUserMsg(text) {
            const container = document.getElementById('mentorMessages');
            const welcome = container.querySelector('.mentor-welcome');
            if (welcome) welcome.remove();
            
            const time = new Date().toLocaleTimeString('es-CL', { hour: '2-digit', minute: '2-digit' });
            const html = `
                <div class="mentor-message user">
                    <div class="mentor-message-content">
                        <div class="mentor-message-bubble">${this.escape(text)}</div>
                        <div class="mentor-message-time">${time}</div>
                    </div>
                    <div class="mentor-message-avatar">üë§</div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', html);
            this.scroll();
        }
        
        addBotMsg(response) {
            const container = document.getElementById('mentorMessages');
            const time = new Date().toLocaleTimeString('es-CL', { hour: '2-digit', minute: '2-digit' });
            
            const actionsHTML = response.actions && response.actions.length > 0
                ? `<div class="mentor-quick-actions">
                    ${response.actions.map(a => `<button class="mentor-quick-btn" onclick="window.mentorChat.sendText('${a}')">${a}</button>`).join('')}
                   </div>`
                : '';
            
            const html = `
                <div class="mentor-message bot">
                    <div class="mentor-message-avatar">ü§ñ</div>
                    <div class="mentor-message-content">
                        <div class="mentor-message-bubble">
                            ${response.text.replace(/\n/g, '<br>')}
                            ${actionsHTML}
                        </div>
                        <div class="mentor-message-time">${time}</div>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', html);
            this.scroll();
        }
        
        sendText(text) {
            document.getElementById('mentorInput').value = text;
            this.send();
        }
        
        showTyping() {
            document.getElementById('mentorTyping').classList.add('active');
            this.scroll();
        }
        
        hideTyping() {
            document.getElementById('mentorTyping').classList.remove('active');
        }
        
        scroll() {
            const container = document.getElementById('mentorMessages');
            setTimeout(() => {
                container.scrollTop = container.scrollHeight;
            }, 100);
        }
        
        escape(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
    }
    
    // Inicializar cuando el DOM est√© listo
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
            window.mentorChat = new MentorChat();
        });
    } else {
        window.mentorChat = new MentorChat();
    }
})();
</script>
</html>
